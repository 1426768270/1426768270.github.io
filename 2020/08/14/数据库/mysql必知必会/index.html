<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>mysql必知必会 | naive的博客</title><meta name="keywords" content="mysql"><meta name="author" content="naive"><meta name="copyright" content="naive"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第3章 使用MySQL123456789101112use crashcourse; #指定使用的数据库show databases;  # 了解数据库，返回数据库列表show tables;  # 返回数据库内表的列表show columns from customers; # 查看customers表中的所有列设置describe customers;  # 同上，查看customers表中的">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql必知必会">
<meta property="og:url" content="http://yoursite.com/2020/08/14/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/index.html">
<meta property="og:site_name" content="naive的博客">
<meta property="og:description" content="第3章 使用MySQL123456789101112use crashcourse; #指定使用的数据库show databases;  # 了解数据库，返回数据库列表show tables;  # 返回数据库内表的列表show columns from customers; # 查看customers表中的所有列设置describe customers;  # 同上，查看customers表中的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/img/photo-1626277787644-47d530591292.jpg">
<meta property="article:published_time" content="2020-08-14T01:32:07.000Z">
<meta property="article:modified_time" content="2021-08-08T08:05:02.310Z">
<meta property="article:author" content="naive">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/img/photo-1626277787644-47d530591292.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/08/14/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'mysql必知必会',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-08 16:05:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="naive的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">28</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/photo-1626277787644-47d530591292.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">naive的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">mysql必知必会</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-14T01:32:07.000Z" title="发表于 2020-08-14 09:32:07">2020-08-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-08-08T08:05:02.310Z" title="更新于 2021-08-08 16:05:02">2021-08-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>41分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="mysql必知必会"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="第3章-使用MySQL"><a href="#第3章-使用MySQL" class="headerlink" title="第3章 使用MySQL"></a>第3章 使用MySQL</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">use crashcourse; #指定使用的数据库</span><br><span class="line">show databases;  # 了解数据库，返回数据库列表</span><br><span class="line">show tables;  # 返回数据库内表的列表</span><br><span class="line">show columns from customers; # 查看customers表中的所有列设置</span><br><span class="line">describe customers;  # 同上，查看customers表中的所有列设置</span><br><span class="line"></span><br><span class="line">show status; # 用于显示广泛的服务器状态信息</span><br><span class="line">show create database crashcourse; #查看创建数据库crashcourse的mysql代码语句</span><br><span class="line">show create table productnotes;  #查看创建表productnotes表的mysql代码语句</span><br><span class="line">show grants; #显示授予用户（所有用户或特定用户）的安全权限</span><br><span class="line"># show errors; # 显示服务器错误内容</span><br><span class="line"># show warnings； #显示服务器警告内容</span><br></pre></td></tr></table></figure>

<h2 id="第4章-检索数据"><a href="#第4章-检索数据" class="headerlink" title="第4章 检索数据"></a>第4章 检索数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># select检索单列，多列，所有列</span><br><span class="line">select prod_name from products;  # 从products表中检索prod_name 单列</span><br><span class="line">select prod_id,prod_name,prod_price from products;   # 从products表中检索prod_name，prod_name,prod_price 多列</span><br><span class="line">select * from products;   #  # 从products表中检索所有列，通常情况下，检索不需要的列会降低检索和应用程序的效率</span><br><span class="line"></span><br><span class="line"># 使用distinct 去重</span><br><span class="line">select distinct vend_id from products;  # 使用distinct关键字去重，distinc只能放在列名的前面</span><br><span class="line">select distinct vend_id,prod_price from products;  # distinct不仅对前置它的列vend_id起作用，同时也作用于prod_price，两列值有重复，才去重</span><br><span class="line"></span><br><span class="line"># 使用limit检索部分行，开始位置为行索引值，索引从0开始</span><br><span class="line">select prod_name from products limit 5; #从第 0 行开始，返回前 5 行</span><br><span class="line">select prod_name from products limit 5,5; #从第 5 行开始，检索 5 行</span><br><span class="line"># 另一种写法</span><br><span class="line">select prod_name from products limit 4 OFFSET 3; #从第 3 行开始，检索 4 行</span><br><span class="line">select prod_name from products limit 3,4; #，同上，从第 3 行开始，检索 4 行</span><br><span class="line"></span><br><span class="line"># 行数不够时，mysql只返回它能返回的那么多行</span><br><span class="line">select count(prod_name) from products; # prod_name 共14行，索引为0-13</span><br><span class="line">select prod_name from products limit 10,5; #从第 10 行开始，检索 5 行，行索引10-14，超出范围，只返回10-13共4行数据</span><br><span class="line"></span><br><span class="line"># 使用完全限定的表名</span><br><span class="line">select products.prod_name from products;</span><br><span class="line">select products.prod_name from crashcourse.products;</span><br></pre></td></tr></table></figure>

<h2 id="第5章-排序检索数据"><a href="#第5章-排序检索数据" class="headerlink" title="第5章 排序检索数据"></a>第5章 排序检索数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/* 关系型数据库设计理论认为，如果不明确规定排序顺序，</span><br><span class="line">则不应该假定检索出的数据的顺序有意义 */</span><br><span class="line"></span><br><span class="line"># order by 子句对输出排序</span><br><span class="line"># 按单列排序 </span><br><span class="line">select prod_name from products order by prod_name;   # 以字母顺序排序prod_name列 </span><br><span class="line">select prod_name from products order by prod_id;  # 使用非检索的列排序数据也是合法的，如使用prod_id顺序排列prod_name</span><br><span class="line"></span><br><span class="line"># 按多列排序 </span><br><span class="line">select prod_id, prod_price,prod_name from products order by prod_price, prod_name; #先按价格，再按产品名排序</span><br><span class="line"></span><br><span class="line"># 降序排列 desc，desc只作用于直接位于其前面的列名</span><br><span class="line">select prod_id, prod_price,prod_name from products order by prod_price desc; # 按价格降序排列</span><br><span class="line">select prod_id, prod_price,prod_name from products order by prod_price desc, prod_name; #先按价格降序排列，再按产品名升序排列 </span><br><span class="line">select prod_id, prod_price,prod_name from products order by prod_price desc, prod_name desc; #先按价格降序排列，再按产品名降序排列</span><br><span class="line"></span><br><span class="line"># 使用order by 和limit组合，找出一列中最高或最低的值</span><br><span class="line"># 顺序：order by子句必须在from子句之后，limit子句必须在order by之后</span><br><span class="line">select prod_price from products order by prod_price desc limit 1; # 最高值 </span><br><span class="line">select prod_price from products order by prod_price limit 1; # 最低值 </span><br></pre></td></tr></table></figure>

<h2 id="第6章-过滤数据"><a href="#第6章-过滤数据" class="headerlink" title="第6章 过滤数据"></a>第6章 过滤数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select prod_name,prod_price from products where prod_price = 2.50;   # 价格等于2.50的产品名、产品价格</span><br><span class="line">select prod_name,prod_price from products where prod_name = &quot;fuses&quot;;  # 默认不区分大小写</span><br><span class="line">select prod_name,prod_price from products where prod_price &lt; 10; # 价格小于10的产品名、产品价格</span><br><span class="line">select prod_name,prod_price from products where prod_price &lt;=10; # 价格小于等于10的产品名、产品价格</span><br><span class="line"></span><br><span class="line"># 不匹配检查</span><br><span class="line">select vend_id,prod_name from products where vend_id &lt;&gt; 1003; # 检索不是由1003供应商制造的所有产品 </span><br><span class="line">select vend_id,prod_name from products where vend_id != 1003; # 同上，检索不是由1003供应商制造的所有产品 </span><br><span class="line"></span><br><span class="line"># 范围值检索，between A and B，包括A和B</span><br><span class="line">select prod_name,prod_price from products where prod_price between 5 and 10; # 价格 大于等于5，小于等于10 的产品名、产品价格</span><br><span class="line"></span><br><span class="line"># 空值检查</span><br><span class="line">select prod_name from products where prod_price is null;  # 返回prod_price为空值null的prod_name,无对应数据 </span><br><span class="line">select cust_id from customers where cust_email is null; # 检索cust_email为空值时的cust_id</span><br><span class="line">/* 在通过过滤选择出不具有特定值的行时，你可能希望返回具有NULL值得行。</span><br><span class="line">但是，不行。因为未知具有特殊的含义，数据库不知道他们是否匹配，所以在匹配过滤和不匹配过滤中不返回NULL。</span><br><span class="line">因此，在过滤数据时，一定要验证返回数据中确实给出了被过滤列具有NULL的行。 </span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<h2 id="第7章-数据过滤"><a href="#第7章-数据过滤" class="headerlink" title="第7章 数据过滤"></a>第7章 数据过滤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># and 或 or 操作符连接多个where子句 </span><br><span class="line"># AND 用在WHERE子句中的关键字，用来指示检索满足所有给定条件的行</span><br><span class="line">select vend_id,prod_price,prod_name from products</span><br><span class="line">where vend_id = 1003 and prod_price &lt;= 10; #检索由供应商1003制造且价格小于等于10美元的产品信息</span><br><span class="line"># OR操作符，指示MySQL检索匹配任一条件的行</span><br><span class="line">select prod_name,prod_price from products </span><br><span class="line">where vend_id = 1002 or vend_id = 1003; # 检索由任一个指定供应商制造的所有产品的产品信息</span><br><span class="line"></span><br><span class="line"># and 和 or结合，and优先计算</span><br><span class="line"># 优先计算and，查找vend_id为1003且价格&gt;=10的产品，或者vend_id为1002的产品，不管价格如何  </span><br><span class="line">select prod_name,prod_price from products </span><br><span class="line">where vend_id = 1002 or vend_id = 1003 and prod_price &gt;= 10;</span><br><span class="line"># 使用圆括号明确运算顺序：查找vend_id为1002或1003，且价格&gt;=10的产品</span><br><span class="line">select prod_name,prod_price from products </span><br><span class="line">where (vend_id = 1002 or vend_id = 1003) and prod_price &gt;= 10; </span><br><span class="line"></span><br><span class="line"># IN操作符</span><br><span class="line"># IN操作符后跟由逗号分隔的合法值清单，整个清单必须括在圆括号</span><br><span class="line">select prod_name,prod_price from products</span><br><span class="line">where vend_id in (1002,1003) order by prod_name;</span><br><span class="line"># IN操作符完成与OR相同的功能</span><br><span class="line">select prod_name,prod_price from products</span><br><span class="line">where vend_id = 1002 or vend_id = 1003 order by prod_name; # 同上 </span><br><span class="line"></span><br><span class="line"># NOT操作符</span><br><span class="line"># 列出1002和1003之外的供应商生产的产品</span><br><span class="line">select prod_name,prod_price from products</span><br><span class="line">where vend_id not in (1002,1003) order by prod_name;</span><br><span class="line"># Mysql支持not对in，between，exsits子句取反 </span><br></pre></td></tr></table></figure>

<h2 id="第8章-用通配符进行过滤"><a href="#第8章-用通配符进行过滤" class="headerlink" title="第8章 用通配符进行过滤"></a>第8章 用通配符进行过滤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">通配符：用来匹配值得一部分的特殊字符 </span><br><span class="line">搜索模式：由字面值、通配符或两者组合构成的搜索条件 </span><br><span class="line">Like操作符：为在搜索子句中使用通配符，必须使用like操作符。</span><br><span class="line">指示mysql，其后跟的搜索模式利用通配符匹配而不是直接相等匹配进行比较。 </span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">-- 通配符类型 </span><br><span class="line"># 百分号 % 通配符 ：表示任何字符（包括0个字符 ）出现任意次数 </span><br><span class="line"># 特殊：注意 % 不能匹配NULL空值！ </span><br><span class="line"># 找到所有以词jet起头的产品 </span><br><span class="line">select prod_id,prod_name from products where prod_name like &quot;jet%&quot;;</span><br><span class="line"># 通配符可以在搜索模式任意位置使用</span><br><span class="line"># 比如下方出现在头尾两处 ，匹配任意位置包含文本anvil的值 </span><br><span class="line">select prod_id,prod_name from products where prod_name like &quot;%anvil%&quot;; </span><br><span class="line"># 比如下方出现在搜索模式的中间，匹配所有以s开头e结尾的值 </span><br><span class="line">select prod_name from products where prod_name like &quot;s%e&quot;; </span><br><span class="line"></span><br><span class="line"># 下划线 _ 通配符 ：匹配一个字符，不能多不能少 </span><br><span class="line">select prod_id,prod_name from products</span><br><span class="line">where prod_name like &quot;_ ton anvil&quot;;</span><br><span class="line"></span><br><span class="line"># 技巧：把通配符至于搜索模式的开始处，搜索起来是最慢的！ </span><br></pre></td></tr></table></figure>

<h2 id="第9章-用正则表达式进行搜索"><a href="#第9章-用正则表达式进行搜索" class="headerlink" title="第9章 用正则表达式进行搜索"></a>第9章 用正则表达式进行搜索</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">-- 基本字符匹配 </span><br><span class="line"># 查找产品名中含有&#x27;1000&#x27;的所有行 </span><br><span class="line">select prod_name from products where prod_name regexp &quot;1000&quot;;</span><br><span class="line"># .在正则表达式中，匹配任意 一个 字符 </span><br><span class="line">select prod_name from products where prod_name regexp &quot;.000&quot;;</span><br><span class="line"></span><br><span class="line">-- like 和 正则表达式的区别 ，是否在列值中匹配 </span><br><span class="line"># like在整个列中查找，如果被匹配的文本出现在列值中，匹配不到结果，除非使用通配符 </span><br><span class="line">select prod_name from products where prod_name like &quot;1000&quot; order by prod_name;     #无返回结果 ,没有1000的</span><br><span class="line"></span><br><span class="line"># like + 通配符</span><br><span class="line">select prod_name from products where prod_name like &quot;%1000&quot; order by prod_name;    # 返回结果&#x27;JetPack 1000&#x27;</span><br><span class="line">select prod_name from products where prod_name like &quot;%000&quot; order by prod_name;     # 返回结果 &#x27;JetPack 1000&#x27; &#x27;JetPack 2000&#x27;</span><br><span class="line"># Regexp在列值中匹配</span><br><span class="line">select prod_name from products where prod_name regexp &quot;.000&quot; order by prod_name;   # 返回结果 &#x27;JetPack 1000&#x27; &#x27;JetPack 2000&#x27;</span><br><span class="line"></span><br><span class="line"># regexp如何匹配整个列，同like效果呢，使用^和$定位符即可 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 正则表达式匹配默认不分大小写，需使用BINARY区分大小写  </span><br><span class="line">select prod_name from products where prod_name regexp binary &quot;JetPack .000&quot;;</span><br><span class="line"></span><br><span class="line">-- 正则表达式的OR操作符： |</span><br><span class="line">select prod_name from products where prod_name regexp &quot;1000|2000&quot; order by prod_name;</span><br><span class="line"></span><br><span class="line">-- 正则表达式匹配几个字符之一 [ ]</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[123] Ton&#x27; order by prod_name;  # [123]匹配单一字符：1或2或3</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[1|2|3] Ton&#x27; order by prod_name;  # [1|2|3]同[123]，匹配单一字符：1或2或3</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;1|2|3 ton&#x27; order by prod_name; # &#x27;1|2|3 ton&#x27;匹配1或2或&#x27;3 ton&#x27;</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[^123]&#x27; order by prod_name;  # 取反</span><br><span class="line"></span><br><span class="line">-- 正则表达式匹配范围 </span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[1-5] Ton&#x27; order by prod_name;  # [1-5]匹配1,2,3,4,5</span><br><span class="line"></span><br><span class="line">-- 正则表达式匹配特殊字符，必须用\\前导，进行转义 </span><br><span class="line">-- 多数正则使用单反斜杠转义，但mysql使用双反斜杠，mysql自己解释一个，正则表达式库解释一个 </span><br><span class="line">select vend_name from vendors where vend_name regexp &quot;\\.&quot; order by vend_name; # ‘\\.&#x27;匹配字符.</span><br><span class="line">select vend_name from vendors where vend_name regexp &quot;.&quot; order by vend_name;  #  &#x27;.&#x27;匹配任意字符，每行都会被检索出来</span><br><span class="line"></span><br><span class="line">-- 正则表达式匹配字符类 </span><br><span class="line">#    [:alnum:]    任意字母和数字（同[a-zA-Z0-9]） </span><br><span class="line">#    [:alpha:]    任意字符（同[a-zA-Z]） </span><br><span class="line">#    [:blank:]    空格和制表（同[\\t]） </span><br><span class="line">#    [:cntrl:]    ASCII控制字符（ASCII 0到31和127） </span><br><span class="line">#    [:digit:]    任意数字（同[0-9]） </span><br><span class="line">#    [:graph:]    与[:print:]相同，但不包括空格 </span><br><span class="line">#    [:lower:]    任意小写字母（同[a-z]） </span><br><span class="line">#    [:print:]    任意可打印字符 </span><br><span class="line">#    [:punct:]    既不在[:alnum:]又不在[:cntrl:]中的任意字符 </span><br><span class="line">#    [:space:]    包括空格在内的任意空白字符（同[\\f\\n\\r\\t\\v]） </span><br><span class="line">#    [:upper:]    任意大写字母（同[A-Z]） </span><br><span class="line">#    [:xdigit:]    任意十六进制数字（同[a-fA-F0-9]） </span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[:digit:]&#x27; order by prod_name; #[:digit:]匹配任意数字 </span><br><span class="line"></span><br><span class="line">-- 匹配多个实例 </span><br><span class="line">#    *        0个或多个匹配 </span><br><span class="line">#    +        1个或多个匹配（等于&#123;1,&#125;）</span><br><span class="line">#    ?        0个或1个匹配（等于&#123;0,1&#125;）</span><br><span class="line">#     &#123;n&#125;        指定数目的匹配 </span><br><span class="line">#     &#123;n,&#125;    不少于指定数目的匹配</span><br><span class="line">#    &#123;n,m&#125;    匹配数目的范围（m不超过255）</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;\\([0-9] sticks?\\)&#x27;</span><br><span class="line">order by prod_name;  # 返回了&#x27;TNT (1 stick)&#x27;和&#x27;TNT (5 sticks)&#x27;</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[[:digit:]]&#123;4&#125;&#x27;</span><br><span class="line">order by prod_name;  # [[:digit:]]&#123;4&#125;匹配连在一起的任意4位数字</span><br><span class="line"></span><br><span class="line">-- 定位符</span><br><span class="line">#    ^            文本的开始 </span><br><span class="line">#    $            文本的结尾 </span><br><span class="line">#    [[:&lt;:]]        词的开始 </span><br><span class="line">#    [[:&gt;:]]        词的结尾</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;^[0-9\\.]&#x27; order by prod_name; #找出以一个数（包括以小数点开始的数）开始的所有产品</span><br><span class="line">select prod_name from products where prod_name regexp &#x27;[0-9\\.]&#x27; order by prod_name;  #找出包括小数点和数字的所有产品</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- ^的双重作用 </span><br><span class="line"># 在集合中（用[和]定义），用它来否定该集合</span><br><span class="line"># 用来指串的开始处</span><br><span class="line"></span><br><span class="line">-- 不适用数据库表进行正则表达式的测试：匹配返回1，无匹配返回0</span><br><span class="line">select &#x27;hello&#x27; regexp &#x27;[0-9]&#x27;; # 返回 0 </span><br><span class="line">select &#x27;hello&#x27; regexp &#x27;[:alnum:]&#x27;; # 返回 1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第10章-创建计算字段"><a href="#第10章-创建计算字段" class="headerlink" title="第10章 创建计算字段"></a>第10章 创建计算字段</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- 拼接字段 concat()拼接串，即把多个串连接起来形成一个较长的串各个串之间用逗号分隔。</span><br><span class="line">select concat(vend_name,&#x27; (&#x27;,vend_country,&#x27;)&#x27;) from vendors order by vend_name;  </span><br><span class="line"></span><br><span class="line">-- 删除数据左侧多余空格 ltrim()</span><br><span class="line">-- 删除数据两侧多余空格 trim()</span><br><span class="line">-- 删除数据右侧多余空格 rtrim()</span><br><span class="line">select concat(rtrim(vend_name),&#x27; (&#x27;,rtrim(vend_country),&#x27;)&#x27;) from vendors order by vend_name;</span><br><span class="line"></span><br><span class="line">-- as赋予别名</span><br><span class="line">select concat(rtrim(vend_name),&#x27; (&#x27;,rtrim(vend_country),&#x27;)&#x27;) as vend_title from vendors order by vend_name;</span><br><span class="line"></span><br><span class="line">-- 执行算数计算</span><br><span class="line">select prod_id,quantity,item_price from orderitems where order_num = 20005;</span><br><span class="line"></span><br><span class="line">select prod_id,quantity,item_price,quantity * item_price as expanded_price</span><br><span class="line">from orderitems where order_num = 20005;  # 计算总价expanded_price</span><br><span class="line"></span><br><span class="line">-- 简单测试计算 </span><br><span class="line">select 2*3;</span><br><span class="line">select trim(&#x27;abc&#x27;);</span><br><span class="line">select now();  # 返回当前日期和时间</span><br></pre></td></tr></table></figure>

<h2 id="第11章-利用数据处理函数"><a href="#第11章-利用数据处理函数" class="headerlink" title="第11章 利用数据处理函数"></a>第11章 利用数据处理函数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">-- 文本处理函数 </span><br><span class="line">#    left()            返回串左边的字符 </span><br><span class="line">#    length()        返回串的长度 </span><br><span class="line">#    locate()        找出串的一个子串 </span><br><span class="line">#    lower()            将串转换为小写</span><br><span class="line">#    ltrim()            去掉串左边的空格</span><br><span class="line">#    right()            返回串右边的字符 </span><br><span class="line">#    rtrim()            去掉串右边的空格  </span><br><span class="line">#    soundex()        返回串的soundex值</span><br><span class="line">#    substring()        返回子串的字符 </span><br><span class="line">#    upper()            将串转换为大写</span><br><span class="line"></span><br><span class="line">-- UPPER()函数 转换文本为大写 </span><br><span class="line">select vend_name, upper(vend_name) as vend_name_upcase from vendors order by vend_name;</span><br><span class="line"></span><br><span class="line"># soundex() 描述语音表示的字母数字模式的算法,对串按照发音比较而不是字母比较</span><br><span class="line">select cust_name,cust_contact from customers where cust_contact = &#x27;Y. Lie&#x27;;  # 无返回 </span><br><span class="line">select cust_name,cust_contact from customers where soundex(cust_contact) = soundex(&#x27;Y. Lie&#x27;); # 按发音搜索 </span><br><span class="line"></span><br><span class="line">-- 日期和时间处理函数 </span><br><span class="line">#    adddate()        增加一个日期（天，周等）</span><br><span class="line">#    addtime()        增加一个时间（时、分等）</span><br><span class="line">#    curdate()        返回当前日期 </span><br><span class="line">#    curtime()        返回当前时间 </span><br><span class="line">#    date()            返回日期时间的日期部分     </span><br><span class="line">#    datediff()        计算两个日期之差 </span><br><span class="line">#    date_add()        高度灵活的日期运算函数 </span><br><span class="line">#    date_format()    返回一个格式化的日期或时间串 </span><br><span class="line">#    day()            返回一个日期的天数部分     </span><br><span class="line">#    dayofweek()        对于一个日期，返回对应的星期几 </span><br><span class="line">#    hour()            返回一个时间的小时部分 </span><br><span class="line">#    minute()        返回一个时间的分钟部分 </span><br><span class="line">#    month()            返回一个日期的月份部分 </span><br><span class="line">#    now()            返回当前日期和事件 </span><br><span class="line">#    second()        返回一个时间的秒部分 </span><br><span class="line">#    time()             返回一个日期时间的时间部分 </span><br><span class="line">#    year()            返回一个日期的年份部分 </span><br><span class="line"></span><br><span class="line"># 首选的日期格式yyyy-mm-dd，避免多义性 </span><br><span class="line">select cust_id,order_num from orders where order_date = &quot;2005-09-01&quot;;</span><br><span class="line">select * from orders; # order_date为datetime数据类型，含有时间信息；如果时间信息不是00:00:00,上句查找无结果</span><br><span class="line"># 按照date()日期进行过滤信息，更可靠 </span><br><span class="line">select cust_id,order_num from orders where date(order_date) = &quot;2005-09-01&quot;;</span><br><span class="line"></span><br><span class="line"># 检索2005年9月下的订单 </span><br><span class="line">select cust_id,order_num from orders where year(order_date) = 2005 and month(order_date) = 9;</span><br><span class="line">select cust_id,order_num from orders where date(order_date) between &quot;2005-09-01&quot; and &quot;2005-09-30&quot;;</span><br><span class="line"></span><br><span class="line">-- 数值处理函数 </span><br><span class="line">#    abs()            返回一个数的绝对值</span><br><span class="line">#    cos()            返回一个角度的余弦</span><br><span class="line">#    exp()            返回一个数的指数值</span><br><span class="line">#    mod()            返回除操作的余数</span><br><span class="line">#    pi()            返回圆周率    </span><br><span class="line">#    sin()            返回一个角度的正弦 </span><br><span class="line">#    sqrt()            返回一个数的平方根 </span><br><span class="line">#    tan()            返回一个角度的正切 </span><br></pre></td></tr></table></figure>

<h2 id="第12章-汇总数据"><a href="#第12章-汇总数据" class="headerlink" title="第12章 汇总数据"></a>第12章 汇总数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"># avg()            返回某列的平均值 </span><br><span class="line"># count()        返回某列的行数 </span><br><span class="line"># max()            返回某列的最大值 </span><br><span class="line"># min()            返回某列的最小值 </span><br><span class="line"># sum()            返回某列值之和 </span><br><span class="line"></span><br><span class="line">-- avg()</span><br><span class="line"># AVG()返回products表中所有产品的平均价格</span><br><span class="line">select avg(prod_price) as avg_price from products;</span><br><span class="line"># 返回特定供应商所提供产品的平均价格</span><br><span class="line">select avg(prod_price) as avg_price from products where vend_id = 1003;</span><br><span class="line"># avg()只能作用于单列，多列使用多个avg()</span><br><span class="line">select avg(item_price) as avg_itemprice,avg(quantity) as avg_quantity from orderitems;</span><br><span class="line"></span><br><span class="line">-- count()</span><br><span class="line"># COUNT(*)对表中行的数目进行计数，不忽略空值 </span><br><span class="line">select count(*) as num_cust from customers; </span><br><span class="line"># 使用COUNT(column)对特定列中具有值的行进行计数，忽略NULL值</span><br><span class="line">select count(cust_email) as num_cust from customers;  </span><br><span class="line"></span><br><span class="line">-- max() &amp; min()</span><br><span class="line"># MAX()返回products表中最贵的物品的价格</span><br><span class="line">select max(prod_price) as max_price from products;</span><br><span class="line"># 在用于文本数据时，如果数据按相应的列排序，则MAX()返回最后一行</span><br><span class="line">select max(prod_name) from products; </span><br><span class="line"># MIN()返回products表中最便宜物品的价格</span><br><span class="line">select min(prod_price) as min_price from products;</span><br><span class="line"># 在用于文本数据时，如果数据按相应的列排序，则MIN()返回最前面一行</span><br><span class="line">select min(prod_name) from products; </span><br><span class="line"></span><br><span class="line">-- sum()</span><br><span class="line"># 检索所订购物品的总数（所有quantity值之和）</span><br><span class="line">select sum(quantity) as items_ordered from orderitems;</span><br><span class="line">select sum(quantity) as items_ordered from orderitems where order_num = 20005;</span><br><span class="line"># 订单20005的总订单金额</span><br><span class="line">select sum(quantity * item_price) as total_price from orderitems where order_num = 20005;</span><br><span class="line"></span><br><span class="line">-- 聚类不同值 distinct</span><br><span class="line"># 使用了DISTINCT参数，因此平均值只考虑各个不同的价格</span><br><span class="line">select avg(distinct prod_price) as avg_price from products where vend_id = 1003;</span><br><span class="line"># distinct 只能作用于count(),不能用于count(*)</span><br><span class="line"># distinct 同max(),min()的结合使用，没有意义 </span><br><span class="line"></span><br><span class="line">-- 组合聚类函数 </span><br><span class="line"># 4个聚集计算:物品的数目，产品价格的最高、最低以及平均值 </span><br><span class="line">SELECT </span><br><span class="line">    COUNT(*) AS num_items,</span><br><span class="line">    MIN(prod_price) AS price_min,</span><br><span class="line">    MAX(prod_price) AS price_max,</span><br><span class="line">    AVG(prod_price) AS price_avg</span><br><span class="line">FROM</span><br><span class="line">    products;</span><br></pre></td></tr></table></figure>

<h2 id="第13章-分组计算"><a href="#第13章-分组计算" class="headerlink" title="第13章 分组计算"></a>第13章 分组计算</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">-- group by 分组 </span><br><span class="line"># 按vend_id排序并分组数据</span><br><span class="line">select vend_id, count(*) as num_prods from products group by vend_id;</span><br><span class="line"># 使用WITH ROLLUP关键字，可以得到每个分组的汇总值，下述语句得到所有分组count(*)的和14 </span><br><span class="line">select vend_id, count(*) as num_prods from products group by vend_id with rollup;</span><br><span class="line"></span><br><span class="line">-- having子句 过滤分组 </span><br><span class="line"># where过滤行，having过滤分组 </span><br><span class="line"># WHERE在数据分组前进行过滤，HAVING在数据分组后进行过滤</span><br><span class="line"># COUNT(*) &gt;=2（两个以上的订单）的那些分组</span><br><span class="line">select cust_id, count(*) as orders from orders group by cust_id having count(*)&gt;=2;</span><br><span class="line"></span><br><span class="line">-- where和having组合使用 </span><br><span class="line">#列出具有2个（含）以上、价格为10（含）以上的产品的供应商</span><br><span class="line">select vend_id,count(*) as num_prods from products where prod_price &gt;=10 group by vend_id having count(*)&gt;=2;</span><br><span class="line">#不加where条件，结果不同 </span><br><span class="line">select vend_id,count(*) as num_prods from products group by vend_id having count(*) &gt;=2;</span><br><span class="line"></span><br><span class="line">-- 分组和排序 </span><br><span class="line"># 检索总计订单价格大于等于50的订单的订单号和总计订单价格</span><br><span class="line">select order_num,sum(quantity * item_price) as ordertotal from orderitems group by order_num having sum(quantity * item_price) &gt;=50;</span><br><span class="line"># 按总计订单价格排序输出</span><br><span class="line">SELECT </span><br><span class="line">    order_num, SUM(quantity * item_price) AS ordertotal</span><br><span class="line">FROM</span><br><span class="line">    orderitems</span><br><span class="line">GROUP BY order_num</span><br><span class="line">HAVING SUM(quantity * item_price) &gt;= 50</span><br><span class="line">ORDER BY ordertotal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- select子句总结及顺序 </span><br><span class="line"># 子句            说明                        是否必须使用 </span><br><span class="line"># select        要返回的列或表达式            是 </span><br><span class="line"># from            从中检索数据的表            仅在从表选择数据时使用 </span><br><span class="line"># where            行级过滤                    否 </span><br><span class="line"># group by        分组说明                    仅在按组计算聚集时使用 </span><br><span class="line"># having        组级过滤                      否 </span><br><span class="line"># order by        输出排序顺序                 否</span><br><span class="line"># limit            要检索的行数                 否 </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第14章-使用子查询"><a href="#第14章-使用子查询" class="headerlink" title="第14章 使用子查询"></a>第14章 使用子查询</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- 利用子查询进行过滤</span><br><span class="line"># 列出订购物品TNT2的所有客户</span><br><span class="line">SELECT cust_name, cust_contact</span><br><span class="line">FROM customers</span><br><span class="line">WHERE cust_id IN (SELECT cust_id</span><br><span class="line">                  FROM orders</span><br><span class="line">                  WHERE order_num IN (SELECT order_num</span><br><span class="line">                                      FROM orderitems</span><br><span class="line">                                      WHERE prod_id = &#x27;TNT2&#x27;));</span><br><span class="line">                                      </span><br><span class="line">                                      </span><br><span class="line">-- 作为计算字段使用子查询</span><br><span class="line"># 对客户10001的订单进行计数</span><br><span class="line">select count(order_num) from orders where cust_id = 10001;</span><br><span class="line"># 显示customers 表中每个客户的订单总数</span><br><span class="line">select cust_name,cust_state, (select count(*) from orders where orders.cust_id = customers.cust_id) as orders</span><br><span class="line">from customers order by cust_name;</span><br></pre></td></tr></table></figure>

<h2 id="第15章-联结表"><a href="#第15章-联结表" class="headerlink" title="第15章 联结表"></a>第15章 联结表</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">-- 创建联结 </span><br><span class="line"># where子句联结 </span><br><span class="line">select vend_name,prod_name,prod_price </span><br><span class="line">from vendors,products</span><br><span class="line">where vendors.vend_id = products.vend_id</span><br><span class="line">order by vend_name,prod_name;</span><br><span class="line"></span><br><span class="line">-- 笛卡尔积 / 叉联结 </span><br><span class="line">/*由没有联结条件的表关系返回的结果为笛卡尔积。</span><br><span class="line">检索出的行的数目将是第一个表中的行数乘以第二个表的行数。*/</span><br><span class="line"></span><br><span class="line"># 删除where联结条件 </span><br><span class="line"># 返回的数据用每个供应商匹配了每个产品，它包括了供应商不正确的产品</span><br><span class="line">select vend_name,prod_name,prod_price </span><br><span class="line">from vendors,products</span><br><span class="line">order by vend_name,prod_name;</span><br><span class="line"></span><br><span class="line">-- 内部联结 inner join ： 表间相等测试 </span><br><span class="line">select vend_name,prod_name,prod_price </span><br><span class="line">from vendors inner join products</span><br><span class="line">on vendors.vend_id = products.vend_id;</span><br><span class="line"></span><br><span class="line"># 编号为20005的订单中的物品及对应情况 </span><br><span class="line">select prod_name,vend_name,prod_price,quantity</span><br><span class="line">from orderitems,products,vendors</span><br><span class="line">where products.vend_id = vendors.vend_id</span><br><span class="line">and orderitems.prod_id = products.prod_id</span><br><span class="line">and order_num = 20005;</span><br><span class="line"></span><br><span class="line"># 订购产品TNT2的客户列表</span><br><span class="line">select cust_name,cust_contact</span><br><span class="line">from customers,orders,orderitems</span><br><span class="line">where customers.cust_id = orders.cust_id</span><br><span class="line">and orders.order_num =  orderitems.order_num</span><br><span class="line">and prod_id = &#x27;TNT2&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="第16章-创建高级联结"><a href="#第16章-创建高级联结" class="headerlink" title="第16章 创建高级联结"></a>第16章 创建高级联结</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">-- 使用表别名</span><br><span class="line"># 给列名或计算字段起别名 </span><br><span class="line"> select concat(rtrim(vend_name),&#x27; (&#x27;,rtrim(vend_country),&#x27;)&#x27;) as vend_title</span><br><span class="line"> from vendors order by vend_name;</span><br><span class="line"> # 给表起别名 </span><br><span class="line"> select cust_name,cust_contact </span><br><span class="line"> from customers as c,orders as o,orderitems as oi</span><br><span class="line"> where c.cust_id = o.cust_id</span><br><span class="line"> and oi.order_num = o.order_num</span><br><span class="line"> and prod_id = &#x27;TNT2&#x27;;</span><br><span class="line"> </span><br><span class="line">-- 自联结 </span><br><span class="line"># ID为DTNTR该物品的供应商生产的其他物品</span><br><span class="line">#方法：子查询 </span><br><span class="line">select prod_id,prod_name from products</span><br><span class="line">where vend_id = (select vend_id from products where prod_id = &#x27;DTNTR&#x27;);</span><br><span class="line"> #方法：使用联结 </span><br><span class="line">select p1.prod_id,p1.prod_name</span><br><span class="line">from products as p1, products as p2</span><br><span class="line">where p1.vend_id = p2.vend_id</span><br><span class="line">and p2.prod_id = &#x27;DTNTR&#x27;;</span><br><span class="line"></span><br><span class="line">-- 自然联结</span><br><span class="line"># 自然联结使每个列只返回一次</span><br><span class="line"># 方法：通过对表使用通配符*，对所有其他表的列使用明确的子集 </span><br><span class="line">select c.*,o.order_num,o.order_date,oi.prod_id,oi.quantity,oi.item_price</span><br><span class="line">from customers as c,orders as o,orderitems as oi</span><br><span class="line">where c.cust_id = o.cust_id</span><br><span class="line">and oi.order_num = o.order_num</span><br><span class="line">and prod_id = &#x27;FB&#x27;;</span><br><span class="line"> </span><br><span class="line">-- 外部联结 </span><br><span class="line"># 检索所有客户及其订单</span><br><span class="line"># 方法： 内部联结 </span><br><span class="line">select customers.cust_id,orders.order_num</span><br><span class="line">from customers inner join orders</span><br><span class="line">on customers.cust_id = orders.cust_id;</span><br><span class="line"> </span><br><span class="line"># 检索所有客户及其订单,包括那些没有订单的客户</span><br><span class="line"># 01 ： 左外部联结</span><br><span class="line">select customers.cust_id,orders.order_num</span><br><span class="line">from customers left outer join orders</span><br><span class="line">on customers.cust_id = orders.cust_id;</span><br><span class="line"></span><br><span class="line"># 02 ：若使用 右外部联结 结果不同 </span><br><span class="line">select customers.cust_id,orders.order_num</span><br><span class="line">from customers right outer join orders</span><br><span class="line">on customers.cust_id = orders.cust_id;</span><br><span class="line"></span><br><span class="line"># 03： 若使用 右外部联结 调换两表位置 结果同01代码相同 </span><br><span class="line">select customers.cust_id,orders.order_num</span><br><span class="line">from orders right outer join customers</span><br><span class="line">on customers.cust_id = orders.cust_id;</span><br><span class="line"> </span><br><span class="line">-- 使用带聚集函数的联结 </span><br><span class="line"> # 检索所有客户分别对应的订单数，inner join </span><br><span class="line">select customers.cust_name,</span><br><span class="line">       customers.cust_id,</span><br><span class="line">       count(orders.order_num) as num_ord</span><br><span class="line">from customers inner join orders </span><br><span class="line">on customers.cust_id = orders.cust_id</span><br><span class="line">group by customers.cust_id; </span><br><span class="line"> </span><br><span class="line">  # 检索所有客户分别对应的订单数，包括没有订单的客户，left outer join </span><br><span class="line"> select customers.cust_name,</span><br><span class="line">       customers.cust_id,</span><br><span class="line">       count(orders.order_num) as num_ord</span><br><span class="line">from customers left outer join orders </span><br><span class="line">on customers.cust_id = orders.cust_id</span><br><span class="line">group by customers.cust_id; </span><br></pre></td></tr></table></figure>

<h2 id="第17章-组合查询"><a href="#第17章-组合查询" class="headerlink" title="第17章 组合查询"></a>第17章 组合查询</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 使用union </span><br><span class="line"># 价格小于等于5的所有物品</span><br><span class="line">select vend_id,prod_id,prod_price from products where prod_price &lt;=5;</span><br><span class="line"># 供应商1001和1002生产的所有物品</span><br><span class="line">select vend_id,prod_id,prod_price from products where vend_id in (1001,1002);</span><br><span class="line"># 价格小于等于5的所有物品的列表，而且包括供应商1001和1002生产的所有物品（不考虑价格）</span><br><span class="line"># 方法1 使用union </span><br><span class="line">select vend_id,prod_id,prod_price from products where prod_price &lt;=5</span><br><span class="line">union</span><br><span class="line">select vend_id,prod_id,prod_price from products where vend_id in (1001,1002);</span><br><span class="line"># 方法2 使用where </span><br><span class="line">select vend_id,prod_id,prod_price from products </span><br><span class="line">where prod_price &lt;=5 or vend_id in (1001,1002);</span><br><span class="line"></span><br><span class="line"># union默认自动去除重复的行 </span><br><span class="line"># union all，匹配所有行 ，不取消重复行 </span><br><span class="line">select vend_id,prod_id,prod_price from products where prod_price &lt;=5</span><br><span class="line">union all</span><br><span class="line">select vend_id,prod_id,prod_price from products where vend_id in (1001,1002);  # 有一行出现2次 </span><br><span class="line"></span><br><span class="line"># 对union组合结果进行排序</span><br><span class="line"># union组合完只能使用一条order by语句，放在最后一个select语句后面 </span><br><span class="line">select vend_id,prod_id,prod_price from products where prod_price &lt;=5</span><br><span class="line">union</span><br><span class="line">select vend_id,prod_id,prod_price from products where vend_id in (1001,1002)</span><br><span class="line">order by vend_id,prod_price;</span><br></pre></td></tr></table></figure>

<h2 id="第18章-全文本搜索"><a href="#第18章-全文本搜索" class="headerlink" title="第18章 全文本搜索"></a>第18章 全文本搜索</h2><ul>
<li>MySQL支持几种基本的数据库引擎。两个最常使用的引擎为<strong>MyISAM</strong>和<strong>InnoDB</strong>，前者支持全文本搜索，后者不支持。</li>
<li><strong>为什么要用全文本搜索？</strong>通配符和正则表达式存在：性能耗时、无法明确控制什么匹配什么不匹配、不能提供智能化的选择结果等问题</li>
<li><strong>一般在创建表时启用全文本搜索</strong>。CREATE TABLE语句接受FULLTEXT子句，给出被索引列的一个逗号分隔的列表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE productnotes</span><br><span class="line">(</span><br><span class="line">   note_id int NOT NULL AUTO_INCREMENT,</span><br><span class="line">   prod_id char(10) NOT NULL,</span><br><span class="line">   note_date datetime NOT NULL,</span><br><span class="line">   note_text text NULL , </span><br><span class="line">   PRIMARY KEY(note_id),</span><br><span class="line">   FULLTEXT(note_text)</span><br><span class="line"> ) ENGINE = MyISAM;</span><br><span class="line"></span><br><span class="line">-- 进行全文本搜索 </span><br><span class="line"># Match() 指定被搜索的列，against()指定要使用的搜索表达式 </span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;rabbit&#x27;);</span><br><span class="line"></span><br><span class="line"># 如果用like语句 </span><br><span class="line">select note_text from productnotes where note_text like &#x27;%rabbit%&#x27;;</span><br><span class="line"></span><br><span class="line"># 演示排序如何工作 </span><br><span class="line">/*  注意：RANK (R)在mysql 8.0.2 (reserved)版本中为keyword保留字</span><br><span class="line">当字段名与MySQL保留字冲突时,可以用字符‘’将字段名括起来</span><br><span class="line">或者改为其他名字，比如as rank1等</span><br><span class="line">*/</span><br><span class="line">select note_text, match(note_text) against(&#x27;rabbit&#x27;) as &#x27;rank&#x27; from productnotes; </span><br><span class="line"></span><br><span class="line">-- 使用查询扩展 </span><br><span class="line"> # 进行一个简单的全文本搜索，没有查询扩展</span><br><span class="line"> select note_text from productnotes where match(note_text) against(&#x27;anvils&#x27;);</span><br><span class="line"> # 相同的搜索，这次使用查询扩展</span><br><span class="line"> select note_text from productnotes where match(note_text) against(&#x27;anvils&#x27; with query expansion);</span><br><span class="line"></span><br><span class="line">-- 布尔文本搜索</span><br><span class="line">-- 全文本布尔操作符 </span><br><span class="line">#    布尔操作符            说明</span><br><span class="line">#    +                包含，词必须存在 </span><br><span class="line">#    -                排除，词必须不出现</span><br><span class="line">#    &gt;                包含，而且增加等级值 </span><br><span class="line">#    &lt;                包含，且减少等级值 </span><br><span class="line">#    ()                把词组成子表达式（允许这些表达式作为一个组被包含、排除、排列等）</span><br><span class="line">#    ~                取消一个词的排序值</span><br><span class="line">#     *                词尾的通配符</span><br><span class="line">#    “ ”                定义一个短语（与单个词的列表不一样，它匹配整个短语一边包含或排除这个短语）</span><br><span class="line"></span><br><span class="line"># 全文本搜索检索包含词heavy的所有行</span><br><span class="line"># 关键字IN BOOLEAN MODE，实际上没有指定布尔操作符，其结果与没有指定布尔方式的结果相同</span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;heavy&#x27; in boolean mode);</span><br><span class="line"># -rope* 排除包含rope*（任何以rope开始的词，包括ropes）的行</span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;heavy -rope*&#x27; in boolean mode);</span><br><span class="line"></span><br><span class="line"># 匹配包含词rabbit和bait的行</span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;+rabbit +bait&#x27; in boolean mode);</span><br><span class="line"></span><br><span class="line"># 不指定操作符，搜索匹配包含rabbit和bait中的至少一个词的行</span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;rabbit bait&#x27; in boolean mode);</span><br><span class="line"></span><br><span class="line"># 搜索匹配短语rabbit bait而不是匹配两个词rabbit和bait。 </span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;&quot;rabbit bait&quot;&#x27; in boolean mode);</span><br><span class="line"></span><br><span class="line"># 匹配rabbit和carrot，增加前者的等级，降低后者的等级</span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;&gt;rabbit &lt;carrot&#x27; in boolean mode);</span><br><span class="line"></span><br><span class="line"># 必须匹配词safe和combination，降低后者的等级</span><br><span class="line">select note_text from productnotes where match(note_text) against(&#x27;+safe +(&lt;combination)&#x27; in boolean mode);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="第19章-插入数据"><a href="#第19章-插入数据" class="headerlink" title="第19章 插入数据"></a>第19章 插入数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">-- 插入完整的行 </span><br><span class="line"># 插入一个新客户到customers表</span><br><span class="line"># 简单但不安全，如果原来表列结构调整，会有问题 </span><br><span class="line">insert into customers values (null,&#x27;Pep E. LaPew&#x27;,&#x27;100 Main Street&#x27;,&#x27;Los Angeles&#x27;,&#x27;CA&#x27;,&#x27;90046&#x27;,&#x27;USA&#x27;,NULL,NULL);</span><br><span class="line"># 表明括号内明确列名，更安全，稍繁琐 </span><br><span class="line">insert into customers (cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country,cust_contact,cust_email)</span><br><span class="line">values (&#x27;Pep E. LaPew&#x27;,&#x27;100 Main Street&#x27;,&#x27;Los Angeles&#x27;,&#x27;CA&#x27;,&#x27;90046&#x27;,&#x27;USA&#x27;,NULL,NULL);</span><br><span class="line"></span><br><span class="line">-- 插入多个行 </span><br><span class="line"># 方法1： 提交多个insert 语句</span><br><span class="line">insert into customers(cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country)</span><br><span class="line">values(&#x27;Pep E. LaPew&#x27;,&#x27;100 Main Street&#x27;,&#x27;Los Angeles&#x27;,&#x27;CA&#x27;,&#x27;90046&#x27;,&#x27;USA&#x27;);</span><br><span class="line">insert into customers(cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country)</span><br><span class="line">values(&#x27;M. Martian&#x27;,&#x27;42 Galaxy Way&#x27;,&#x27;New York&#x27;,&#x27;NY&#x27;,&#x27;11213&#x27;,&#x27;USA&#x27;);</span><br><span class="line"># 方法2： 只要每条INSERT语句中的列名（和次序）相同，可以如下组合各语句</span><br><span class="line"># 单条INSERT语句有多组值，每组值用一对圆括号括起来，用逗号分隔</span><br><span class="line">insert into customers(cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country)</span><br><span class="line">values(&#x27;Pep E. LaPew&#x27;,&#x27;100 Main Street&#x27;,&#x27;Los Angeles&#x27;,&#x27;CA&#x27;,&#x27;90046&#x27;,&#x27;USA&#x27;),(&#x27;M. Martian&#x27;,&#x27;42 Galaxy Way&#x27;,&#x27;New York&#x27;,&#x27;NY&#x27;,&#x27;11213&#x27;,&#x27;USA&#x27;);</span><br><span class="line"></span><br><span class="line">-- 插入检索出来的值 </span><br><span class="line"># 新建custnew表（非书本内容）</span><br><span class="line">CREATE TABLE `custnew` (</span><br><span class="line">  `cust_id` int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `cust_name` char(50) NOT NULL,</span><br><span class="line">  `cust_address` char(50) DEFAULT NULL,</span><br><span class="line">  `cust_city` char(50) DEFAULT NULL,</span><br><span class="line">  `cust_state` char(5) DEFAULT NULL,</span><br><span class="line">  `cust_zip` char(10) DEFAULT NULL,</span><br><span class="line">  `cust_country` char(50) DEFAULT NULL,</span><br><span class="line">  `cust_contact` char(50) DEFAULT NULL,</span><br><span class="line">  `cust_email` char(255) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (`cust_id`)</span><br><span class="line">) ENGINE=InnoDB;</span><br><span class="line"></span><br><span class="line"># 在表custnew中插入一行数据 （非书本内容）</span><br><span class="line">insert into custnew (cust_id,cust_contact,cust_email,cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country)</span><br><span class="line">values(null,null,&#x27;mysql carsh course@learning.com&#x27;,&#x27;Y.CARY&#x27;,&#x27;BAKE WAY&#x27;,&#x27;NEW YORK&#x27;,&#x27;NY&#x27;,&#x27;112103&#x27;,&#x27;USA&#x27;);</span><br><span class="line"></span><br><span class="line"># 将custnew中内容插入到customers表中 </span><br><span class="line"># 同书本代码不同，这里省略了custs_id,这样MySQL就会生成新值。</span><br><span class="line">insert into customers (cust_contact,cust_email,cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country)</span><br><span class="line">select cust_contact,cust_email,cust_name,cust_address,cust_city,cust_state,cust_zip,cust_country from custnew;</span><br></pre></td></tr></table></figure>

<h2 id="第20章-更新和删除数据"><a href="#第20章-更新和删除数据" class="headerlink" title="第20章 更新和删除数据"></a>第20章 更新和删除数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- update语句 : 删除或更新指定列 </span><br><span class="line"># 更新： 客户10005现在有了电子邮件地址</span><br><span class="line">update customers set cust_email = &#x27;elmer@fudd.com&#x27; where cust_id = 10005;</span><br><span class="line"># 更新： 多个列 </span><br><span class="line">UPDATE customers </span><br><span class="line">SET cust_name = &#x27;The Fudds&#x27;,</span><br><span class="line">    cust_email = &#x27;elmer@fudd.com&#x27;</span><br><span class="line">WHERE cust_id = 10005;</span><br><span class="line"></span><br><span class="line"># 删除： 某个列的值，可设置它为NULL（假如表定义允许NULL值）</span><br><span class="line">update customers set cust_email = null where cust_id = 10005;</span><br><span class="line"></span><br><span class="line">-- delete 语句： 删除整行而不是某列 </span><br><span class="line"># 从customers表中删除一行</span><br><span class="line">delete from customers where cust_id = 10006;</span><br><span class="line"></span><br><span class="line">-- truncate table语句 </span><br><span class="line"># 如果想从表中删除 所有行，不要使用DELETE，可使用TRUNCATE TABLE语句</span><br><span class="line"># TRUNCATE实际是删除原来的表并重新创建一个表，而不是逐行删除表中的数据</span><br></pre></td></tr></table></figure>

<h2 id="第21章-创建和操纵表"><a href="#第21章-创建和操纵表" class="headerlink" title="第21章 创建和操纵表"></a>第21章 创建和操纵表</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">-- 新建表 create table</span><br><span class="line"># 参书本配套文件create.sql</span><br><span class="line"></span><br><span class="line">-- 更新表 alter table </span><br><span class="line"># 给vendors表增加一个名为vend_phone的列</span><br><span class="line">alter table vendors </span><br><span class="line">add vend_phone char(20);</span><br><span class="line"># 删除刚刚添加的列</span><br><span class="line">alter table vendors</span><br><span class="line">drop column vend_phone;</span><br><span class="line"></span><br><span class="line"># ALTER TABLE的一种常见用途是定义外键</span><br><span class="line"># 以下为书本配套文件create.sql中定义外键的语句 </span><br><span class="line">ALTER TABLE orderitems ADD CONSTRAINT fk_orderitems_orders FOREIGN KEY (order_num) REFERENCES orders (order_num);</span><br><span class="line">ALTER TABLE orderitems ADD CONSTRAINT fk_orderitems_products FOREIGN KEY (prod_id) REFERENCES products (prod_id);</span><br><span class="line">ALTER TABLE orders ADD CONSTRAINT fk_orders_customers FOREIGN KEY (cust_id) REFERENCES customers (cust_id);</span><br><span class="line">ALTER TABLE products ADD CONSTRAINT fk_products_vendors FOREIGN KEY (vend_id) REFERENCES vendors (vend_id);</span><br><span class="line"></span><br><span class="line">-- 删除表</span><br><span class="line"># 删除customers2表（假设它存在）</span><br><span class="line">drop table customers2;</span><br><span class="line"></span><br><span class="line">-- 重命名表 </span><br><span class="line"># 使用RENAME TABLE语句可以重命名一个表 (假设存在下述表)</span><br><span class="line">rename table customers2 to customers;</span><br><span class="line"># 对多个表重命名(假设存在下述表)</span><br><span class="line">rename table backup_customers to customer,</span><br><span class="line">             backup_vendors to vendors,</span><br><span class="line">             backup_products to products;</span><br></pre></td></tr></table></figure>

<h2 id="第22章-使用视图"><a href="#第22章-使用视图" class="headerlink" title="第22章 使用视图"></a>第22章 使用视图</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">/*视图提供了一种MySQL的SELECT语句层次的封装，可用来简化数据处理以及重新格式化基础数据或保护基础数据。 */ </span><br><span class="line">#视图是虚拟的表；视图只包含使用时动态检索数据的查询。</span><br><span class="line">-- 创建视图 create view</span><br><span class="line">-- 创建视图的语句 show create view viewname</span><br><span class="line">-- 删除视图 drop view viewname</span><br><span class="line">-- 更新视图 1. 先drop后create 2. 直接用create or repalce view</span><br><span class="line"></span><br><span class="line"># 创建一个名为productcustomers的视图</span><br><span class="line">create view productcustomers as</span><br><span class="line">select cust_name,cust_contact,prod_id</span><br><span class="line">from customers,orders,orderitems</span><br><span class="line">where customers.cust_id = orders.cust_id</span><br><span class="line">and orders.order_num = orderitems.order_num;</span><br><span class="line"># 检索订购了产品TNT2的客户</span><br><span class="line">select cust_name,cust_contact from productcustomers where prod_id = &#x27;TNT2&#x27;;</span><br><span class="line"></span><br><span class="line"># 用视图重新格式化检索出的数据</span><br><span class="line"># (来自第10章）在单个组合计算列中返回供应商名和位置</span><br><span class="line">select concat(rtrim(vend_name),&#x27; (&#x27;,rtrim(vend_country),&#x27;)&#x27;) as vend_title from vendors order by vend_name;</span><br><span class="line"># 若经常使用上述格式组合，可以创建视图 </span><br><span class="line">create view vendorlocations as</span><br><span class="line">select concat(rtrim(vend_name),&#x27; (&#x27;,rtrim(vend_country),&#x27;)&#x27;) as vend_title from vendors order by vend_name;</span><br><span class="line"># 检索出以创建所有邮件标签的数据</span><br><span class="line">select * from vendorlocations;</span><br><span class="line"></span><br><span class="line"># 用视图过滤不想要的数据</span><br><span class="line"># 定义customeremaillist视图，它过滤没有电子邮件地址的客户</span><br><span class="line">create view customeremaillist as </span><br><span class="line">select cust_id,cust_name,cust_email from customers</span><br><span class="line">where cust_email is not null;</span><br><span class="line">select * from customeremaillist;</span><br><span class="line"></span><br><span class="line"># 使用视图与计算字段</span><br><span class="line"># (来自第10章）检索某个特定订单中的物品，计算每种物品的总价格</span><br><span class="line">select prod_id,quantity,item_price,quantity*item_price as expanded_price from orderitems where order_num = 20005;</span><br><span class="line"># 将其转换为一个视图</span><br><span class="line">create view orderitemsexpanded as </span><br><span class="line">select order_num,prod_id,quantity,item_price,quantity*item_price as expanded_price from orderitems;</span><br><span class="line"># 创建视图的时候select添加了列名order_num,否则无法按照order_num进行过滤查找 </span><br><span class="line">select * from orderitemsexpanded where order_num = 20005;</span><br><span class="line"></span><br><span class="line"># 更新视图 </span><br><span class="line"># 视图中虽然可以更新数据，但是有很多的限制。</span><br><span class="line"># 一般情况下，最好将视图作为查询数据的虚拟表，而不要通过视图更新数据</span><br></pre></td></tr></table></figure>

<h2 id="第23章-使用存储过程"><a href="#第23章-使用存储过程" class="headerlink" title="第23章 使用存储过程"></a>第23章 使用存储过程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">-- 创建存储过程 </span><br><span class="line"># 返回产品平均价格的存储过程</span><br><span class="line"></span><br><span class="line">create procedure productpricing()</span><br><span class="line">begin</span><br><span class="line">    select avg(prod_price) as priceaverage from products;</span><br><span class="line">end;</span><br><span class="line"></span><br><span class="line"># 调用上述存储过程 </span><br><span class="line">call productpricing();</span><br><span class="line"></span><br><span class="line">-- 删除存储过程,请注意:没有使用后面的()，只给出存储过程名。</span><br><span class="line">drop procedure productpricing;</span><br><span class="line"></span><br><span class="line">-- 使用参数 out</span><br><span class="line"># 重新定义存储过程productpricing</span><br><span class="line"></span><br><span class="line">create procedure productpricing(</span><br><span class="line">    out pl decimal(8,2), out ph decimal(8,2), out pa decimal(8,2))</span><br><span class="line">begin</span><br><span class="line">    select min(prod_price) into pl from products;</span><br><span class="line">    select max(prod_price) into ph from products;</span><br><span class="line">    select avg(prod_price) into pa from products;</span><br><span class="line">end;</span><br><span class="line">/*此存储过程接受3个参数：pl存储产品最低价格，ph存储产品最高价格，pa存储产品平均价格。每个参数必须具有指定的类型，这里使用十进制值。关键词OUT指出相应的参数用来从存储过程传出一个值（返回给调用者）。MySQL支持IN（传递给存储过程）、OUT(从存储过程传出)和INOUT（对存储过程传入和传出）类型的参数。*/</span><br><span class="line"></span><br><span class="line"># 为调用上述存储过程，必须指定3个变量名 所有MySQL变量都必须以@开始。</span><br><span class="line">call productpricing(@pricelow,@pricehigh,@priceaverage);</span><br><span class="line"></span><br><span class="line"># 显示检索出的产品平均价格</span><br><span class="line">select @priceaverage;</span><br><span class="line"># 获得3个值</span><br><span class="line">select @pricehigh,@pricelow,@priceaverage;</span><br><span class="line"></span><br><span class="line">-- 使用参数 in 和 out</span><br><span class="line"># 使用IN和OUT参数,存储过程ordertotal接受订单号并返回该订单的合计</span><br><span class="line">delimiter //</span><br><span class="line">create procedure ordertotal(</span><br><span class="line">    in onumber int,                   # onumber定义为IN，因为订单号被传入存储过程</span><br><span class="line">    out ototal decimal(8,2)            # ototal为OUT，因为要从存储过程返回合计</span><br><span class="line">)</span><br><span class="line">begin</span><br><span class="line">    select sum(item_price*quantity) from orderitems </span><br><span class="line">    where order_num = onumber</span><br><span class="line">    into ototal;</span><br><span class="line">end //</span><br><span class="line">delimiter ;</span><br><span class="line"># 给ordertotal传递两个参数；</span><br><span class="line"># 第一个参数为订单号，第二个参数为包含计算出来的合计的变量名</span><br><span class="line">call ordertotal(20005,@total);</span><br><span class="line"># 显示此合计</span><br><span class="line">select @total;</span><br><span class="line"># 得到另一个订单的合计显示</span><br><span class="line">call ordertotal(20009,@total);</span><br><span class="line">select @total;</span><br><span class="line"></span><br><span class="line">-- 建立智能存储过程 </span><br><span class="line"># 获得与以前一样的订单合计，但只针对某些顾客对合计增加营业税</span><br><span class="line"></span><br><span class="line">-- Name:ordertotal</span><br><span class="line">-- Parameters: onumber = order number</span><br><span class="line">--                taxable = 0 if not taxable, 1 if taxable</span><br><span class="line">--                ototal  = order total variable</span><br><span class="line">delimiter //</span><br><span class="line">create procedure ordertotal(</span><br><span class="line">    in onumber int,</span><br><span class="line">    in taxable boolean,</span><br><span class="line">    out ototal decimal(8,2)</span><br><span class="line">) comment &#x27;obtain order total, optionally adding tax&#x27;</span><br><span class="line">begin</span><br><span class="line">    -- declare variable for total 定义局部变量total</span><br><span class="line">    declare total decimal(8,2);</span><br><span class="line">    -- declare tax percentage 定义局部变量税率 </span><br><span class="line">    declare taxrate int default 6;</span><br><span class="line">    -- get the order total 获得订单合计</span><br><span class="line">    SELECT SUM(item_price * quantity)</span><br><span class="line">    FROM orderitems</span><br><span class="line">    WHERE order_num = onumber INTO total;</span><br><span class="line">    -- is this taxable? 是否要增加营业税？ </span><br><span class="line">    if taxable then</span><br><span class="line">        -- Yes,so add taxrate to the total 给订单合计增加税率</span><br><span class="line">        select total+(total/100*taxrate) into total;</span><br><span class="line">    end if;</span><br><span class="line">    -- and finally,save to out variable 最后，传递给输出变量 </span><br><span class="line">    SELECT total INTO ototal;</span><br><span class="line">END //</span><br><span class="line">delimiter ;</span><br><span class="line"># 调用上述存储过程，不加税 </span><br><span class="line">call ordertotal(20005,0,@total);</span><br><span class="line">select @total;</span><br><span class="line"># 调用上述存储过程，加税 </span><br><span class="line">call ordertotal(20005,1,@total);</span><br><span class="line">select @total;</span><br><span class="line"></span><br><span class="line"># 显示用来创建一个存储过程的CREATE语句</span><br><span class="line">show create procedure ordertotal;</span><br><span class="line"></span><br><span class="line"># 获得包括何时、由谁创建等详细信息的存储过程列表</span><br><span class="line"># 该语句列出所有存储过程</span><br><span class="line">show procedure status;</span><br><span class="line"># 过滤模式 </span><br><span class="line">show procedure status like &#x27;ordertotal&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="第24章-使用游标"><a href="#第24章-使用游标" class="headerlink" title="第24章 使用游标"></a>第24章 使用游标</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">/*游标是一个存储在MySQL服务器上的数据库查询，它不是一条SELECT语句，而是被该语句检索出来的结果集。</span><br><span class="line">游标使得用户可以根据需要滚动浏览屏幕上的数据。</span><br><span class="line"></span><br><span class="line">游标只能用于存储过程（和函数）*/</span><br><span class="line"></span><br><span class="line">-- 创建、打开、关闭游标 </span><br><span class="line"># 定义名为ordernumbers的游标，检索所有订单</span><br><span class="line">delimiter //</span><br><span class="line">create procedure processorders()</span><br><span class="line">begin</span><br><span class="line">    -- decalre the cursor 声明游标 </span><br><span class="line">    declare ordernumbers cursor</span><br><span class="line">    for</span><br><span class="line">    select order_num from orders;</span><br><span class="line">    </span><br><span class="line">    -- open the cursor 打开游标</span><br><span class="line">    open ordernumbers;</span><br><span class="line">    -- close the cursor 关闭游标</span><br><span class="line">    close ordernumbers;</span><br><span class="line">end //</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">-- 使用游标数据 </span><br><span class="line"># 例1：检索 当前行 的order_num列，对数据不做实际处理</span><br><span class="line">delimiter //</span><br><span class="line">create procedure processorders()</span><br><span class="line">begin</span><br><span class="line"></span><br><span class="line">    -- declare local variables 声明局部变量</span><br><span class="line">    declare o int;</span><br><span class="line">    </span><br><span class="line">    -- decalre the cursor 声明游标 </span><br><span class="line">    declare ordernumbers cursor</span><br><span class="line">    for</span><br><span class="line">    select order_num from orders;</span><br><span class="line">    </span><br><span class="line">    -- open the cursor 打开游标</span><br><span class="line">    open ordernumbers;</span><br><span class="line">    </span><br><span class="line">    -- get order number 获得订单号 </span><br><span class="line">    fetch ordernumbers into o;</span><br><span class="line">    /*fetch检索 当前行 的order_num列（将自动从第一行开始）到一个名为o的局部声明变量中。</span><br><span class="line">    对检索出的数据不做任何处理。*/</span><br><span class="line">        </span><br><span class="line">    -- close the cursor 关闭游标</span><br><span class="line">    close ordernumbers;</span><br><span class="line"></span><br><span class="line">END //</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># 例2：循环检索数据，从第一行到最后一行，对数据不做实际处理</span><br><span class="line">delimiter //</span><br><span class="line">create procedure processorders()</span><br><span class="line">begin</span><br><span class="line">    -- declare local variables 声明局部变量</span><br><span class="line">    declare done boolean default 0;</span><br><span class="line">    declare o int;</span><br><span class="line">   </span><br><span class="line">    -- decalre the cursor 声明游标 </span><br><span class="line">    declare ordernumbers cursor</span><br><span class="line">    for</span><br><span class="line">    select order_num from orders;</span><br><span class="line">   </span><br><span class="line">    -- declare continue handler</span><br><span class="line">    declare continue handler for sqlstate &#x27;02000&#x27; set done =1;</span><br><span class="line">    -- SQLSTATE &#x27;02000&#x27;是一个未找到条件，当REPEAT由于没有更多的行供循环而不能继续时，出现这个条件。</span><br><span class="line">    </span><br><span class="line">    -- open the cursor 打开游标</span><br><span class="line">    open ordernumbers;</span><br><span class="line">    </span><br><span class="line">    -- loop through all rows 遍历所有行 </span><br><span class="line">    repeat</span><br><span class="line">    </span><br><span class="line">    -- get order number 获得订单号 </span><br><span class="line">    fetch ordernumbers into o;</span><br><span class="line">    -- FETCH在REPEAT内，因此它反复执行直到done为真</span><br><span class="line">    </span><br><span class="line">    -- end of loop</span><br><span class="line">    until done end repeat;</span><br><span class="line">    </span><br><span class="line">    -- close the cursor 关闭游标</span><br><span class="line">    close ordernumbers;</span><br><span class="line"></span><br><span class="line">end //</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 例3：循环检索数据，从第一行到最后一行，对取出的数据进行某种实际的处理</span><br><span class="line">delimiter //</span><br><span class="line">create procedure processorders()</span><br><span class="line">begin</span><br><span class="line">    -- declare local variables 声明局部变量 </span><br><span class="line">    declare done boolean default 0;</span><br><span class="line">    declare o int;</span><br><span class="line">    declare t decimal(8,2);</span><br><span class="line">    </span><br><span class="line">    -- declare the cursor 声明游标</span><br><span class="line">    declare ordernumbers cursor</span><br><span class="line">    for</span><br><span class="line">    select order_num from orders;</span><br><span class="line">    </span><br><span class="line">    -- declare continue handler</span><br><span class="line">    declare continue handler for sqlstate &#x27;02000&#x27; set done = 1;</span><br><span class="line">    </span><br><span class="line">    -- create a table to store the results 新建表以保存数据</span><br><span class="line">    create table if not exists ordertotals</span><br><span class="line">    (order_num int,total decimal(8,2));</span><br><span class="line">    </span><br><span class="line">    -- open the cursor 打开游标</span><br><span class="line">    open ordernumbers;</span><br><span class="line">    </span><br><span class="line">    -- loop through all rows 遍历所有行</span><br><span class="line">    repeat</span><br><span class="line">    </span><br><span class="line">    -- get order number 获取订单号</span><br><span class="line">    fetch ordernumbers into o;</span><br><span class="line">    </span><br><span class="line">    -- get the total for this order 计算订单金额</span><br><span class="line">    call ordertotal(o,1,t);  # 参见23章代码，已创建可使用</span><br><span class="line">    </span><br><span class="line">    -- insert order and total into ordertotals 将订单号、金额插入表ordertotals内</span><br><span class="line">    insert into ordertotals(order_num,total) values(o,t);</span><br><span class="line">    </span><br><span class="line">    -- end of loop</span><br><span class="line">    until done end repeat;</span><br><span class="line">    </span><br><span class="line">    -- close the cursor 关闭游标</span><br><span class="line">    close ordernumbers;</span><br><span class="line"></span><br><span class="line">end // </span><br><span class="line">delimiter ;</span><br><span class="line"># 调用存储过程 precessorders()</span><br><span class="line">call processorders();</span><br><span class="line"># 输出结果</span><br><span class="line">select * from ordertotals;</span><br></pre></td></tr></table></figure>

<h2 id="第25章-使用触发器"><a href="#第25章-使用触发器" class="headerlink" title="第25章 使用触发器"></a>第25章 使用触发器</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">-- 创建触发器 </span><br><span class="line">create trigger newproduct after insert on products for each row select &#x27;product added&#x27; into @new_pro</span><br><span class="line">#仅支持表 只有表才支持触发器,每个表最多支持6个触发器</span><br><span class="line"># mysql 5.0以上版本在TRIGGER中不能返回结果集，定义了变量 @new_pro;</span><br><span class="line">insert into products(prod_id,vend_id,prod_name,prod_price) values (&#x27;ANVNEW&#x27;,&#x27;1005&#x27;,&#x27;3 ton anvil&#x27;,&#x27;6.09&#x27;); # 插入一行 </span><br><span class="line">select @new_pro;  # 显示Product added消息</span><br><span class="line"></span><br><span class="line">-- 删除触发器 </span><br><span class="line">drop trigger newproduct;</span><br><span class="line"></span><br><span class="line">-- 使用触发器 </span><br><span class="line"># insert触发器</span><br><span class="line">create trigger neworder </span><br><span class="line">after insert on orders for each row select new.order_num into @order_num;</span><br><span class="line">insert into orders(order_date,cust_id) values (now(),10001);</span><br><span class="line">select @order_num;</span><br><span class="line"></span><br><span class="line"># delete触发器</span><br><span class="line"># 使用OLD保存将要被删除的行到一个存档表中 </span><br><span class="line">delimiter //</span><br><span class="line">create trigger deleteorder before delete on orders for each row</span><br><span class="line">begin</span><br><span class="line">    insert into archive_orders(order_num,order_date,cust_id)</span><br><span class="line">    values(old.order_num,old.order_date,old.cust_id); # 引用一个名为OLD的虚拟表，访问被删除的行</span><br><span class="line">end //</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># update触发器</span><br><span class="line"># 在更新vendors表中的vend_state值时，插入前先修改为大写格式 </span><br><span class="line">create trigger updatevendor before update on vendors </span><br><span class="line">for each row set new.vend_state = upper(new.vend_state);</span><br><span class="line"># 更新1001供应商的州为china</span><br><span class="line">update vendors set vend_state = &#x27;china&#x27; where vend_id =1001;</span><br><span class="line"># 查看update后数据，1001供应商对应的vend_state自动更新为大写的CHINA</span><br><span class="line">select * from vendors;</span><br></pre></td></tr></table></figure>

<h2 id="第26章-管理事务处理"><a href="#第26章-管理事务处理" class="headerlink" title="第26章 管理事务处理"></a>第26章 管理事务处理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-- 事务 transaction 指一组sql语句</span><br><span class="line">-- 回退 rollback 指撤销指定sql语句的过程</span><br><span class="line">-- 提交 commit 指将未存储的sql语句结果写入数据库表</span><br><span class="line">-- 保留点 savepoint 指事务处理中设置的临时占位符，可以对它发布回退（与回退整个事务处理不同）</span><br><span class="line"></span><br><span class="line">-- 控制事务处理</span><br><span class="line"># 开始事务及回退 </span><br><span class="line">select * from ordertotals;   # 查看ordertotals表显示不为空</span><br><span class="line">start transaction;           # 开始事务处理 </span><br><span class="line">delete from ordertotals;     # 删除ordertotals表中所有行</span><br><span class="line">select * from ordertotals;   # 查看ordertotals表显示 为空</span><br><span class="line">rollback;                     # rollback语句回退 </span><br><span class="line">select * from ordertotals;   # rollback后，再次查看ordertotals表显示不为空</span><br><span class="line"></span><br><span class="line"># commit 提交 </span><br><span class="line">start transaction;</span><br><span class="line">delete from orderitems where order_num = 20010;</span><br><span class="line">delete from orders where order_num = 20010;</span><br><span class="line">commit;   # 仅在上述两条语句不出错时写出更改 </span><br><span class="line"></span><br><span class="line"># savepoint 保留点 </span><br><span class="line"># 创建保留点</span><br><span class="line">savepoint delete1;</span><br><span class="line"># 回退到保留点 </span><br><span class="line">rollback to delete1;</span><br><span class="line"># 释放保留点 </span><br><span class="line">release savepoint delete1;</span><br><span class="line"></span><br><span class="line">-- 更改默认的提交行为 </span><br><span class="line">set autocommit = 0;  # 设置autocommit为0（假）指示MySQL不自动提交更改</span><br></pre></td></tr></table></figure>

<h2 id="第27章-全球化和本地化"><a href="#第27章-全球化和本地化" class="headerlink" title="第27章 全球化和本地化"></a>第27章 全球化和本地化</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">-- 字符集和校对顺序</span><br><span class="line"># 查看所支持的字符集完整列表</span><br><span class="line">show character set;</span><br><span class="line"># 查看所支持校对的完整列表,以及它们适用的字符集</span><br><span class="line">show collation;</span><br><span class="line"># 确定所用系统的字符集和校对</span><br><span class="line">show variables like &#x27;character%&#x27;;</span><br><span class="line">show variables like &#x27;collation%&#x27;;</span><br><span class="line"># 使用带子句的CREATE TABLE，给表指定字符集和校对</span><br><span class="line">create table mytable</span><br><span class="line">(</span><br><span class="line">    column1 int,</span><br><span class="line">    column2 varchar(10)</span><br><span class="line">) default character set hebrew </span><br><span class="line">  collate hebrew_general_ci;</span><br><span class="line"># 除了能指定字符集和校对的表范围外，MySQL还允许对每个列设置它们</span><br><span class="line">create table mytable</span><br><span class="line">(</span><br><span class="line">    column1 int,</span><br><span class="line">    column2 varchar(10),</span><br><span class="line">    column3 varchar(10) character set latin1 collate latin1_general_ci</span><br><span class="line">)default character set hebrew </span><br><span class="line"> collate hebrew_general_ci;</span><br><span class="line"># 校对collate在对用ORDER BY子句排序时起重要的作用</span><br><span class="line"># 如果要用与创建表时不同的校对顺序排序,可在SELECT语句中说明 </span><br><span class="line">select * from customers order by lastname,firstname collate latin1_general_cs;</span><br></pre></td></tr></table></figure>

<h2 id="第28章-安全管理"><a href="#第28章-安全管理" class="headerlink" title="第28章 安全管理"></a>第28章 安全管理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- 管理用户</span><br><span class="line"># 需要获得所有用户账号列表时</span><br><span class="line"># mysql数据库有一个名为user的表，它包含所有用户账号。user表有一个名为user的列</span><br><span class="line">use mysql;</span><br><span class="line">select user from user;</span><br><span class="line"></span><br><span class="line">-- 创建用户账号 </span><br><span class="line"># 使用create user</span><br><span class="line">create user ben identified by &#x27;p@$$w0rd&#x27;;</span><br><span class="line"># 重命名一个用户账号</span><br><span class="line">rename user ben to bforta;</span><br><span class="line"># 删除用户账号 </span><br><span class="line">drop user bforta;</span><br><span class="line"># 查看赋予用户账号的权限</span><br><span class="line">show grants for bforta;</span><br><span class="line"># 允许用户在（crashcourse数据库的所有表）上使用SELECT，只读</span><br><span class="line">grant select on crashcourse.* to bforta;</span><br><span class="line"># 重新查看赋予用户账号的权限，发生变化 </span><br><span class="line">show grants for bforta;</span><br><span class="line"># 撤销特定的权限</span><br><span class="line">revoke select on crashcourse.* from bforta;</span><br><span class="line"># 简化多次授权</span><br><span class="line">grant select,insert on crashcourse.* to bforta;</span><br><span class="line"></span><br><span class="line">-- 更改口令</span><br><span class="line"></span><br><span class="line"># 原来课本中使用的password()加密函数，在8.0版本中已经移除 </span><br><span class="line"># password() :This function was removed in MySQL 8.0.11.</span><br><span class="line">set password for bforta = &#x27;n3w p@$$w0rd&#x27;;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 如果不指定用户名，直接修改当前登录用户的口令 </span><br><span class="line">set password = &#x27;n3w p@$$w0rd&#x27;;</span><br></pre></td></tr></table></figure>

</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/mysql/">mysql</a></div><div class="post_share"><div class="social-share" data-image="/./img/photo-1626277787644-47d530591292.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/14/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql%E7%9A%84in%E5%92%8Cexist%E5%8C%BA%E5%88%AB/"><img class="prev-cover" src="/./img/photo-1465156799763-2c087c332922.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">mysql的in和exist区别</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/13/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"><img class="next-cover" src="/./img/photo-1626811407568-2f41c53fff99.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">操作系统-常见面试题</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/08/14/数据库/mysql的in和exist区别/" title="mysql的in和exist区别"><img class="cover" src="/./img/photo-1465156799763-2c087c332922.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-14</div><div class="title">mysql的in和exist区别</div></div></a></div><div><a href="/2020/08/15/数据库/mysql高级/" title="mysql高级"><img class="cover" src="/./img/photo-1628009193228-076ab63d655a.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-15</div><div class="title">mysql高级</div></div></a></div><div><a href="/2020/08/14/数据库/mysql事务和锁/" title="mysql事务和锁"><img class="cover" src="/./img/photo-1626277787644-47d530591292.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-14</div><div class="title">mysql事务和锁</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC3%E7%AB%A0-%E4%BD%BF%E7%94%A8MySQL"><span class="toc-number">1.</span> <span class="toc-text">第3章 使用MySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">2.</span> <span class="toc-text">第4章 检索数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0-%E6%8E%92%E5%BA%8F%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">3.</span> <span class="toc-text">第5章 排序检索数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC6%E7%AB%A0-%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">4.</span> <span class="toc-text">第6章 过滤数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0-%E6%95%B0%E6%8D%AE%E8%BF%87%E6%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">第7章 数据过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC8%E7%AB%A0-%E7%94%A8%E9%80%9A%E9%85%8D%E7%AC%A6%E8%BF%9B%E8%A1%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">6.</span> <span class="toc-text">第8章 用通配符进行过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC9%E7%AB%A0-%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%9B%E8%A1%8C%E6%90%9C%E7%B4%A2"><span class="toc-number">7.</span> <span class="toc-text">第9章 用正则表达式进行搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC10%E7%AB%A0-%E5%88%9B%E5%BB%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">8.</span> <span class="toc-text">第10章 创建计算字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC11%E7%AB%A0-%E5%88%A9%E7%94%A8%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="toc-number">9.</span> <span class="toc-text">第11章 利用数据处理函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC12%E7%AB%A0-%E6%B1%87%E6%80%BB%E6%95%B0%E6%8D%AE"><span class="toc-number">10.</span> <span class="toc-text">第12章 汇总数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC13%E7%AB%A0-%E5%88%86%E7%BB%84%E8%AE%A1%E7%AE%97"><span class="toc-number">11.</span> <span class="toc-text">第13章 分组计算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC14%E7%AB%A0-%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">12.</span> <span class="toc-text">第14章 使用子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC15%E7%AB%A0-%E8%81%94%E7%BB%93%E8%A1%A8"><span class="toc-number">13.</span> <span class="toc-text">第15章 联结表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC16%E7%AB%A0-%E5%88%9B%E5%BB%BA%E9%AB%98%E7%BA%A7%E8%81%94%E7%BB%93"><span class="toc-number">14.</span> <span class="toc-text">第16章 创建高级联结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC17%E7%AB%A0-%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">15.</span> <span class="toc-text">第17章 组合查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC18%E7%AB%A0-%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">16.</span> <span class="toc-text">第18章 全文本搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC19%E7%AB%A0-%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">17.</span> <span class="toc-text">第19章 插入数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC20%E7%AB%A0-%E6%9B%B4%E6%96%B0%E5%92%8C%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">18.</span> <span class="toc-text">第20章 更新和删除数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC21%E7%AB%A0-%E5%88%9B%E5%BB%BA%E5%92%8C%E6%93%8D%E7%BA%B5%E8%A1%A8"><span class="toc-number">19.</span> <span class="toc-text">第21章 创建和操纵表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC22%E7%AB%A0-%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">20.</span> <span class="toc-text">第22章 使用视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC23%E7%AB%A0-%E4%BD%BF%E7%94%A8%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">21.</span> <span class="toc-text">第23章 使用存储过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC24%E7%AB%A0-%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87"><span class="toc-number">22.</span> <span class="toc-text">第24章 使用游标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC25%E7%AB%A0-%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">23.</span> <span class="toc-text">第25章 使用触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC26%E7%AB%A0-%E7%AE%A1%E7%90%86%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">24.</span> <span class="toc-text">第26章 管理事务处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC27%E7%AB%A0-%E5%85%A8%E7%90%83%E5%8C%96%E5%92%8C%E6%9C%AC%E5%9C%B0%E5%8C%96"><span class="toc-number">25.</span> <span class="toc-text">第27章 全球化和本地化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC28%E7%AB%A0-%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-number">26.</span> <span class="toc-text">第28章 安全管理</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By naive</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>