<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>naive的博客</title><meta name="author" content="naive"><meta name="copyright" content="naive"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="欢迎访问naive的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="naive的博客">
<meta property="og:url" content="http://yoursite.com/page/13/index.html">
<meta property="og:site_name" content="naive的博客">
<meta property="og:description" content="欢迎访问naive的博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:author" content="naive">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/page/13/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'naive的博客',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-03-19 12:13:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="naive的博客" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">130</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/./img/preview.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">naive的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">naive的博客</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/1426768270" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:liuqi8270@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/07/15/java%E5%9F%BA%E7%A1%80/jvm-%E8%BF%90%E8%A1%8C%E6%97%B6%E7%A9%BA%E9%97%B4%E5%88%92%E5%88%86/" title="jvm(2)--栈">     <img class="post_bg" src="/./img/photo-1442522772768-9032b6d10e3e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jvm(2)--栈"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/15/java%E5%9F%BA%E7%A1%80/jvm-%E8%BF%90%E8%A1%8C%E6%97%B6%E7%A9%BA%E9%97%B4%E5%88%92%E5%88%86/" title="jvm(2)--栈">jvm(2)--栈</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-15T05:57:15.000Z" title="发表于 2020-07-15 13:57:15">2020-07-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">


运行时数据区内部结构

java虚拟机定了了若干种程序运行期间会使用到的运行时数据区，其中有一些会随着虚拟机启动而创建，随着虚拟机退出而销毁。另外一些则是与县城一一对应的，这些与线程对应的数据区域会随着线程开始和结束而创建和销毁。如图，灰色的区域为单独线程私有的，红色的为多个线程共享的
1.每个线程：独立包括程序计数器、栈、本地栈
2.线程间共享：堆、堆外内存（方法区、永久代或元空间、代码缓存）
一般来说，jvm优化95%是优化堆区，5%优化的是方法区，至于栈区无非出入栈操作优化较少
每个Java应用程序都有一个Runtime类的实例，该实例允许该应用程序与运行该应用程序的环境进行交互。 当前运行时可以从getRuntime方法获得。
线程1.线程是一个程序里的运行单元，JVM允许一个程序有多个线程并行的执行；
2.在HotSpot JVM，每个线程都与操作系统的本地线程直接映射。
　　当一个java线程准备好执行以后，此时一个操作系统的本地线程也同时创建。java线程执行终止后。本地线程也会回收。
3.操作系统负责所有线程的安排调度到任何一个可用的CPU上。一旦本地线程初始化成 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/07/15/java%E5%9F%BA%E7%A1%80/java%E5%A4%9A%E7%BA%BF%E7%A8%8B(4)/" title="多线程（4）">     <img class="post_bg" src="/./img/photo-1465188162913-8fb5709d6d57.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多线程（4）"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/15/java%E5%9F%BA%E7%A1%80/java%E5%A4%9A%E7%BA%BF%E7%A8%8B(4)/" title="多线程（4）">多线程（4）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-14T16:40:19.000Z" title="发表于 2020-07-15 00:40:19">2020-07-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">集合类不安全List 不安全

1234567891011121314151617181920212223// java.util.ConcurrentModificationException 并发修改异常！public class ListTest &#123;    public static void main(String[] args) &#123;        // 并发下 ArrayList 不安全的吗，Synchronized；        /*** 解决方案；        * 1、List&lt;String&gt; list = new Vector&lt;&gt;();        * 2、List&lt;String&gt; list = Collections.synchronizedList(new ArrayList&lt;&gt; ());        * 3、List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;()；  		*/        // CopyOnWrite 写入 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/07/15/java%E5%9F%BA%E7%A1%80/java%E5%A4%9A%E7%BA%BF%E7%A8%8B(3)/" title="多线程（3）">     <img class="post_bg" src="/./img/photo-1626811407568-2f41c53fff99.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多线程（3）"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/15/java%E5%9F%BA%E7%A1%80/java%E5%A4%9A%E7%BA%BF%E7%A8%8B(3)/" title="多线程（3）">多线程（3）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-14T16:40:06.000Z" title="发表于 2020-07-15 00:40:06">2020-07-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">Lockreentrantlock使用reentrantlock可以完成sync的功能
CAS锁
需要注意的是，必须要必须要必须要手动释放锁（重要的事情说三遍）
使用syn锁定的话如果遇到异常，jvm会自动释放锁，但是lock必须手动释放锁，因此经常在finally中进行锁的释放


1234567891011121314151617181920212223242526272829303132333435public class T02_ReentrantLock2 &#123;   Lock lock = new ReentrantLock();   void m1() &#123;      try &#123;         lock.lock(); //synchronized(this)         for (int i = 0; i &lt; 10; i++) &#123;            TimeUnit.SECONDS.sleep(1);            System.out.println(i);         &#125;      &#125; ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/07/15/java%E5%9F%BA%E7%A1%80/java%E5%A4%9A%E7%BA%BF%E7%A8%8B(2)/" title="多线程（2）">     <img class="post_bg" src="/./img/photo-1443891238287-325a8fddd0f7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多线程（2）"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/15/java%E5%9F%BA%E7%A1%80/java%E5%A4%9A%E7%BA%BF%E7%A8%8B(2)/" title="多线程（2）">多线程（2）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-14T16:39:47.000Z" title="发表于 2020-07-15 00:39:47">2020-07-15</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">并发synchronized是可重入锁
synchronized是jdk提供的jvm层面的同步机制。它解决的是多线程之间访问共享资源的同步问题,它保证了在被它修饰的方法或代码块同一时间只有一个线程执行。
sync(Object) 不能实验String常量 Integer Long


java6之前的synchronized属于重量锁,性能较差,它是基于操作系统的Mutex Lock互斥量实现的。
因为java线程是映射到操作系统的线程之上的,所以暂停或唤醒线程都需要Java程序从用户态转换为内核态,这段转换时间消耗较长。

java6之后jvm团队对synchronized做出了非常大的优化。

synchronized底层原理先看我编写的一段测试代码:

使用 javap -c -v -l 指令反编译 class文件后的 字节码指令 如下

可以清楚的看到,在进入synchronized的时候，底层字节码编译出来的指令为monitorenter,在执行完同步代码块后又有一个monitorexit指令.
想了解synchronized究竟是如何实现的,可以直接进入openjdk:sr ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/07/12/java%E5%9F%BA%E7%A1%80/GC/" title="GC">     <img class="post_bg" src="/./img/photo-1625777719130-0a8e07086117.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GC"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/12/java%E5%9F%BA%E7%A1%80/GC/" title="GC">GC</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-12T07:28:15.000Z" title="发表于 2020-07-12 15:28:15">2020-07-12</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">
GC
判断对象存活的方法
引用计数法缺点
什么是GC Root ?


垃圾回收算法
复制算法(Copying)
标记-清除算法(Mark-Sweep)
标记-整理算法(Mark-Compact)
分代收集算法
内存分配与垃圾回收策略
一次GC的过程
动态年龄阈值


垃圾回收器
Serial串行收集器
Serial Old 串行收集器(老年代版本)
Parallel Scavenge 并行多线程收集器
Parallel Old 并行收集器(老年代版本)
ParNew 多线程收集器
CMS 并发标记清除收集器
CMS收集器回收过程
G1 收集器
G1回收器的特点
G1收集器回收过程







GC判断对象存活的方法在垃圾回收器对堆内存回收前，需要判断对象是否存活。

引用计数算法: 给每个对象添加一个引用计数器,每当对象被引用,对象的引用计数器就加1,当引用失效时,引用计数器就减1。直到引用计数器为0,就代表对象不再被引用。

可达性算法: 通过GC ROOT的对象节点往下搜索,节点走过的路径被称为引用链。如果一个对象不处于任何引用链,那么就可以判断此对象是不可达的。


引用计 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/07/12/java%E5%9F%BA%E7%A1%80/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="多线程">     <img class="post_bg" src="/./img/photo-1626277787644-47d530591292.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多线程"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/12/java%E5%9F%BA%E7%A1%80/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="多线程">多线程</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-12T07:27:18.000Z" title="发表于 2020-07-12 15:27:18">2020-07-12</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">

多线程进程和线程进程与线程最主要的区别是它们是操作系统管理资源的不同方式的体现。准确来说进程与线程属于衍生关系。进程是操作系统执行程序的一次过程,在这个过程中可能会产生多个线程。

比如在使用QQ时，有窗口线程，文字发送的线程，语音输入的线程，可能不是很恰当，但是就是这个意思。

由于系统在线程之间的切换比在进程之间的切换更高效率，所以线程也被成为轻量级进程。
并发和并行
并发: 多个程序可以同时运行的现象，更细化的是多进程可以同时运行或者多指令可以同时运行。多个线程任务被一个cpu轮流执行。并发强调的是计算机应用程序有处理多个任务的能力。并发的”同时”是经过上下文快速切换，使得看上去多个进程同时都在运行的现象，是一种OS欺骗用户的现象。


并行:多个线程被多个cpu同时执行。这里也并不是只允许多个cpu处理多任务，一个cpu也是可以的，只要cpu能在同一时刻处理多任务。并行的”同时”是同一时刻可以多个进程在运行(处于running)
并行强调的是计算机应用程序拥有同时处理多任务的能力。




并发和并行对比并发，指的是多个事情，在同一时间段内同时发生了。
并行，指的是多个事情 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/07/12/java%E5%9F%BA%E7%A1%80/Java%E9%9B%86%E5%90%88/" title="java集合">     <img class="post_bg" src="/./img/photo-1626427832435-d6c500cc2686.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="java集合"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/12/java%E5%9F%BA%E7%A1%80/Java%E9%9B%86%E5%90%88/" title="java集合">java集合</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-12T07:26:44.000Z" title="发表于 2020-07-12 15:26:44">2020-07-12</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">
java集合
线程不安全的集合
HashMap的特点
HashMap的长度(容量)为什么要设计成2的幂？
HashTable的特点
TreeMap
ArrayList的特点
Vector的特点
LinkedList的特点
Set
ConcurrentModificationException异常


线程安全的集合
线程安全的 List
CopyOnWriteArrayList
线程安全的Set
线程安全的Map
ConcurrentHashMap
ConcurrentSkipListMap








java集合线程不安全的集合HashMap的特点
HashMap在Jdk8之前使用拉链法实现,jdk8之后使用拉链法+红黑树实现。

HashMap是线程不安全的,并允许null key 和 null value。**

HashMap在我当前的jdk版本(11)的默认容量为0,在第一次添加元素的时候才初始化容量为 16,之后才扩容为原来的2倍。

HashMap的扩容是根据 threshold决定的 : threshold = loadFactor * capacity。当 s ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/07/12/java%E5%9F%BA%E7%A1%80/%E8%AF%BE%E5%A0%82%E9%9A%8F%E7%AC%94-%E5%91%A8%E9%98%B3/" title="jvm-周阳">     <img class="post_bg" src="/./img/photo-1443891238287-325a8fddd0f7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jvm-周阳"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/12/java%E5%9F%BA%E7%A1%80/%E8%AF%BE%E5%A0%82%E9%9A%8F%E7%AC%94-%E5%91%A8%E9%98%B3/" title="jvm-周阳">jvm-周阳</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-12T07:25:48.000Z" title="发表于 2020-07-12 15:25:48">2020-07-12</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">


灰色：线程私有
亮色：所有线程共享，存在垃圾回收
1.类加载器.class结果类加载器 变成Class
jdk自己的类 是bootstrap 加载器  mull
自己编写的类走的是$AppClassLoader 加载器
sun.misc.Launcher   jvm调用的入口程序
虚拟机自带的加载器启动类 bootstrap
扩展类 extension
应用程序类 appclassloader
用户自定义加载器java.lang.ClassLoader的子类，用户自己实现
双亲委派机制一个类收到了类加载请求，他首先不会尝试自己去加载这个类，而是把这个请求委派给父类去完成，每一个层次类加载器都是如此，因此所有的加载请求都应该传送到启动类加载其中，只有当父类加载器反馈自己无法完成这个请求的时候（在它的加载路径下没有找到所需加载的Class），子类加载器才会尝试自己去加载。 
沙箱安全自定义string类，但是在加载自定义String类的时候会率先使用引导类加载器加载，而引导类加载器在加载的过程中会先加载jdk自带的文件（rt.jar包中java\lang\String.class）， ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/07/12/java%E5%9F%BA%E7%A1%80/JVM/" title="jvm">     <img class="post_bg" src="/./img/photo-1465156799763-2c087c332922.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jvm"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/12/java%E5%9F%BA%E7%A1%80/JVM/" title="jvm">jvm</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-12T07:18:32.000Z" title="发表于 2020-07-12 15:18:32">2020-07-12</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java%E5%9F%BA%E7%A1%80/">java基础</a></span></div><div class="content">
JVM
JVM运行时内存分区
程序计数器
程序计数器的特点
Java虚拟机栈
栈帧
局部变量表
操作数栈
动态连接
方法出口
本地方法栈
堆
方法区


JavaVirtualMachineError
StackOverflowError
OutOfMemoryError







JVMPS:JVM部分参考了《深入理解Java虚拟机 - 第二版》(周志明).个人认为《深入理解Java虚拟机 - 第二版》上的部分内容已经过时有些知识请各位同学明鉴，此外我后续会根据 《深入理解Java虚拟机 - 第三版》的内容来做更新和修改。
JVM运行时内存分区
以HotSpot为例:


JDK8之前: 

线程私有的部分有:程序计数器(PC寄存器),JAVA虚拟机栈,本地方法栈(native)。

线程共享部分有: GC堆,永久代(是方法区的一种实现)。






JDK8之后:

线程私有的部分不变, 线程共享部分的永久代改为了元空间(MetaSpace)(永久代和元空间都是方法区的实现),字符串常量池也移动到了heap空间



     
程序计数器程序计数器是一块较小的内存空间，它 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/07/12/hello-world/" title="Hello World">     <img class="post_bg" src="/./img/photo-1627819376920-9faac124cf13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/07/12/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-07-12T05:52:22.712Z" title="发表于 2020-07-12 13:52:22">2020-07-12</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.


Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo generate

More info: Generating
Deploy to remote sites1$ hexo deploy

More info: Deployment
博客的搭建与备份https://www.jianshu.com/p/9b87aae19093
备份博客由于博 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/12/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/#content-inner">12</a><span class="page-number current">13</span></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">naive</div><div class="author-info__description">欢迎访问naive的博客</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">130</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/1426768270"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/1426768270" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:liuqi8270@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到navie的博客</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/12/Go/Go%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%8F%8D%E5%B0%84%E5%92%8C%E7%BD%91%E7%BB%9C/" title="Go文件测试反射和网络"><img src="/./img/photo-1465188162913-8fb5709d6d57.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go文件测试反射和网络"/></a><div class="content"><a class="title" href="/2022/03/12/Go/Go%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%8F%8D%E5%B0%84%E5%92%8C%E7%BD%91%E7%BB%9C/" title="Go文件测试反射和网络">Go文件测试反射和网络</a><time datetime="2022-03-12T08:38:16.000Z" title="发表于 2022-03-12 16:38:16">2022-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/23/Go/Go%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="Go面向对象"><img src="/./img/photo-1626427832435-d6c500cc2686.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go面向对象"/></a><div class="content"><a class="title" href="/2022/02/23/Go/Go%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="Go面向对象">Go面向对象</a><time datetime="2022-02-23T14:52:21.000Z" title="发表于 2022-02-23 22:52:21">2022-02-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/21/Go/%E6%95%B0%E7%BB%84%E5%88%87%E7%89%87%E5%92%8Cmap/" title="数组、切片和map"><img src="/./img/photo-1627819376920-9faac124cf13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数组、切片和map"/></a><div class="content"><a class="title" href="/2022/02/21/Go/%E6%95%B0%E7%BB%84%E5%88%87%E7%89%87%E5%92%8Cmap/" title="数组、切片和map">数组、切片和map</a><time datetime="2022-02-21T13:06:06.000Z" title="发表于 2022-02-21 21:06:06">2022-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/20/Go/Go%E7%AE%80%E4%BB%8B/" title="Go简介"><img src="/./img/photo-1465156799763-2c087c332922.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go简介"/></a><div class="content"><a class="title" href="/2022/01/20/Go/Go%E7%AE%80%E4%BB%8B/" title="Go简介">Go简介</a><time datetime="2022-01-20T09:47:21.000Z" title="发表于 2022-01-20 17:47:21">2022-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/" title="设计模式-职责链模式"><img src="/./img/photo-1626427832435-d6c500cc2686.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="设计模式-职责链模式"/></a><div class="content"><a class="title" href="/2022/01/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/" title="设计模式-职责链模式">设计模式-职责链模式</a><time datetime="2022-01-18T15:21:05.000Z" title="发表于 2022-01-18 23:21:05">2022-01-18</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Go/"><span class="card-category-list-name">Go</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Netty/"><span class="card-category-list-name">Netty</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring/"><span class="card-category-list-name">Spring</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Vue/"><span class="card-category-list-name">Vue</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">java基础</span><span class="card-category-list-count">19</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/leetcode/"><span class="card-category-list-name">leetcode</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/redis/"><span class="card-category-list-name">redis</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"><span class="card-category-list-name">云原生</span><span class="card-category-list-count">20</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/java/" style="font-size: 1.45em; color: rgb(162, 31, 154)">java</a><a href="/tags/jvm/" style="font-size: 1.33em; color: rgb(50, 23, 195)">jvm</a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.3em; color: rgb(47, 100, 96)">多线程</a><a href="/tags/java%E9%9B%86%E5%90%88/" style="font-size: 1.21em; color: rgb(162, 10, 116)">java集合</a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.27em; color: rgb(26, 5, 28)">前端</a><a href="/tags/html/" style="font-size: 1.15em; color: rgb(134, 24, 154)">html</a><a href="/tags/redis/" style="font-size: 1.18em; color: rgb(50, 110, 81)">redis</a><a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 1.15em; color: rgb(142, 187, 67)">读书笔记</a><a href="/tags/hadoop/" style="font-size: 1.15em; color: rgb(169, 165, 92)">hadoop</a><a href="/tags/mysql/" style="font-size: 1.21em; color: rgb(33, 94, 97)">mysql</a><a href="/tags/springboot/" style="font-size: 1.15em; color: rgb(198, 187, 146)">springboot</a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.15em; color: rgb(98, 20, 86)">注解</a><a href="/tags/shiro/" style="font-size: 1.15em; color: rgb(158, 8, 97)">shiro</a><a href="/tags/swagger2/" style="font-size: 1.15em; color: rgb(16, 42, 104)">swagger2</a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.42em; color: rgb(170, 118, 168)">设计模式</a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.27em; color: rgb(13, 48, 13)">笔记</a><a href="/tags/SpringSecurity/" style="font-size: 1.21em; color: rgb(14, 107, 181)">SpringSecurity</a><a href="/tags/git/" style="font-size: 1.18em; color: rgb(156, 90, 114)">git</a><a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.15em; color: rgb(178, 35, 38)">算法</a><a href="/tags/%E7%AE%97%E6%B3%95%E5%BC%8F/" style="font-size: 1.15em; color: rgb(123, 177, 191)">算法式</a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.15em; color: rgb(25, 120, 78)">网络</a><a href="/tags/Vue%E5%9F%BA%E7%A1%80/" style="font-size: 1.21em; color: rgb(67, 81, 57)">Vue基础</a><a href="/tags/jQuery/" style="font-size: 1.15em; color: rgb(20, 180, 131)">jQuery</a><a href="/tags/SpringCloud/" style="font-size: 1.15em; color: rgb(47, 150, 19)">SpringCloud</a><a href="/tags/ActiveMQ/" style="font-size: 1.15em; color: rgb(82, 140, 67)">ActiveMQ</a><a href="/tags/k8s/" style="font-size: 1.36em; color: rgb(180, 124, 177)">k8s</a><a href="/tags/%E5%AE%B9%E5%99%A8%E4%BA%91/" style="font-size: 1.39em; color: rgb(81, 154, 79)">容器云</a><a href="/tags/TypeScript/" style="font-size: 1.15em; color: rgb(98, 41, 167)">TypeScript</a><a href="/tags/vue3/" style="font-size: 1.15em; color: rgb(117, 162, 47)">vue3</a><a href="/tags/axios/" style="font-size: 1.15em; color: rgb(29, 58, 143)">axios</a><a href="/tags/es6/" style="font-size: 1.15em; color: rgb(183, 126, 118)">es6</a><a href="/tags/css/" style="font-size: 1.15em; color: rgb(60, 101, 20)">css</a><a href="/tags/linux/" style="font-size: 1.24em; color: rgb(147, 167, 178)">linux</a><a href="/tags/shell/" style="font-size: 1.18em; color: rgb(70, 185, 26)">shell</a><a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 1.15em; color: rgb(95, 40, 168)">正则表达式</a><a href="/tags/docker/" style="font-size: 1.27em; color: rgb(195, 180, 19)">docker</a><a href="/tags/go/" style="font-size: 1.21em; color: rgb(92, 5, 0)">go</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><span class="card-archive-list-count">14</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/10/"><span class="card-archive-list-date">十月 2021</span><span class="card-archive-list-count">11</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">7</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">130</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2020-04-29T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">544.3k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-03-19T04:13:53.305Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By naive</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    var typed = new Typed("#subtitle", {
      strings: "今日事&#44;今日畢,Never put off till tomorrow what you can do today".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '今日事&#44;今日畢'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>